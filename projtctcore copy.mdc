---
alwaysApply: false
---

@startuml

' ==========================================
' ğŸ—ï¸ XYç›¸é‡æ´¾å®Œæ•´ç³»ç»Ÿ - ç»¼åˆç±»å›¾è®¾è®¡ v2.0
' 18å¼ è¡¨å®ç°å®Œæ•´åŠŸèƒ½ï¼šç”¨æˆ·+å†…å®¹+äº¤æ˜“+èŠå¤©+è¯é¢˜+åª’ä½“+é€šçŸ¥
' è®¾è®¡ç†å¿µï¼šè®¡ç®—ä¼˜äºå­˜å‚¨ï¼ŒJSONçµæ´»æ‰©å±•ï¼Œæ¨¡å—åŒ–æ¶æ„
' æ–°å¢ï¼šè¯é¢˜ã€è¯„è®ºã€åª’ä½“ã€é€šçŸ¥ã€æ ‡ç­¾ã€ä¸¾æŠ¥ã€æœç´¢å†å²
' ==========================================

' ===== æ ¸å¿ƒç”¨æˆ·æ¨¡å— (4è¡¨) =====

class User {
    + id : Long
    + username : String  
    + mobile : String
    + password : String
    + status : Integer
    + created_at : DateTime
    --
    ' ç”¨æˆ·åŸºç¡€ä¿¡æ¯è¡¨
    ' id: ç”¨æˆ·å”¯ä¸€æ ‡è¯†(é›ªèŠ±ID)
    ' username: ç™»å½•ç”¨æˆ·å(å”¯ä¸€)
    ' mobile: æ‰‹æœºå·(å”¯ä¸€,ç™»å½•å‡­è¯)
    ' password: å¯†ç å“ˆå¸Œå€¼
    ' status: ç”¨æˆ·çŠ¶æ€(0=ç¦ç”¨,1=æ­£å¸¸,2=å†»ç»“)
    ' created_at: æ³¨å†Œæ—¶é—´
}

class UserProfile {
    + user_id : Long
    + nickname : String
    + avatar : String
    + metadata : JSON
    --
    ' ç”¨æˆ·èµ„æ–™æ‰©å±•è¡¨
    ' user_id: å…³è”ç”¨æˆ·ID
    ' nickname: ç”¨æˆ·æ˜µç§°(æ˜¾ç¤ºå,1-20å­—)
    ' avatar: å¤´åƒURL(Mediaè¡¨file_url)
    ' metadata: æ‰©å±•ä¿¡æ¯JSON
    '   {email, real_name, gender, birthday,
    '    height, weight, city, district,
    '    wechat, bio, ip_location, activity_score}
    '
    ' ç”¨æˆ·è¡Œä¸ºç¤ºä¾‹ï¼š
    ' - ç¼–è¾‘æ˜µç§°ï¼šUPDATE nickname='æ–°æ˜µç§°'
    ' - ä¸Šä¼ å¤´åƒï¼šMediaä¸Šä¼ â†’UPDATE avatar=url
    ' - å®Œå–„èµ„æ–™ï¼šUPDATE metadata JSONå­—æ®µ
    ' - è®¾ç½®å¾®ä¿¡ï¼šmetadata.wechat='sunny0713'
}

class UserWallet {
    + user_id : Long
    + balance : Long
    + version : Integer
    --
    ' ç”¨æˆ·é’±åŒ…è¡¨(ä¹è§‚é”ä¿è¯å¹¶å‘å®‰å…¨)
    ' user_id: å…³è”ç”¨æˆ·ID
    ' balance: ä½™é¢(åˆ†ä¸ºå•ä½,é¿å…ç²¾åº¦é—®é¢˜)
    '   å¦‚ï¼š100å…ƒå­˜å‚¨ä¸º10000åˆ†
    ' version: ä¹è§‚é”ç‰ˆæœ¬å·(å¹¶å‘æ§åˆ¶)
    '
    ' ç”¨æˆ·è¡Œä¸ºç¤ºä¾‹ï¼š
    ' - å……å€¼ï¼šbalance += 10000, version++
    ' - æ”¯ä»˜è®¢å•ï¼šbalance -= 1500, version++
    '   WHERE user_id=xxx AND version=current_version
    ' - é€€æ¬¾ï¼šbalance += 1500, version++
    ' - æŸ¥è¯¢ä½™é¢ï¼šSELECT balance/100 AS yuan
}

class Transaction {
    + id : Long
    + user_id : Long
    + amount : Long
    + type : String
    + ref_id : String
    + created_at : DateTime
    --
    ' ç»Ÿä¸€äº¤æ˜“æµæ°´è¡¨(æ‰€æœ‰èµ„é‡‘å˜åŠ¨è®°å½•)
    ' id: äº¤æ˜“è®°å½•ID
    ' user_id: ç”¨æˆ·ID
    ' amount: äº¤æ˜“é‡‘é¢(åˆ†,æ­£=æ”¶å…¥,è´Ÿ=æ”¯å‡º)
    ' type: äº¤æ˜“ç±»å‹
    '   'recharge'=å……å€¼
    '   'consume'=æ¶ˆè´¹
    '   'income'=æ”¶å…¥
    '   'refund'=é€€æ¬¾
    '   'withdraw'=æç°
    ' ref_id: å…³è”ä¸šåŠ¡ID(è®¢å•å·/æ´»åŠ¨IDç­‰)
    ' created_at: äº¤æ˜“æ—¶é—´
    '
    ' ç”¨æˆ·è¡Œä¸ºç¤ºä¾‹ï¼š
    ' - ä¸‹å•æ¶ˆè´¹ï¼šINSERT (amount=-1500, type='consume', ref_id=order_id)
    ' - æä¾›æœåŠ¡æ”¶æ¬¾ï¼šINSERT (amount=+1500, type='income', ref_id=order_id)
    ' - å……å€¼ï¼šINSERT (amount=+10000, type='recharge')
    ' - é€€æ¬¾ï¼šINSERT (amount=+1500, type='refund', ref_id=order_id)
}

' ===== å†…å®¹æ¨¡å— (3è¡¨) =====

class Content {
    + id : Long
    + user_id : Long
    + type : Integer
    + title : String
    + data : JSON
    + status : Integer
    + created_at : DateTime
    --
    ' ä¸‡èƒ½å†…å®¹è¡¨(åŠ¨æ€/æ´»åŠ¨/æŠ€èƒ½)
    ' id: å†…å®¹å”¯ä¸€ID
    ' user_id: åˆ›å»ºè€…ID
    ' type: å†…å®¹ç±»å‹
    '   1=åŠ¨æ€å‘å¸ƒ(æ–‡å­—/å›¾æ–‡/è§†é¢‘åŠ¨æ€)
    '   2=æ´»åŠ¨ç»„å±€(Kæ­Œ/å°çƒ/æ¢åº—æ´»åŠ¨)
    '   3=æŠ€èƒ½æœåŠ¡(æ¸¸æˆé™ªç©/ç”Ÿæ´»æœåŠ¡)
    ' title: å†…å®¹æ ‡é¢˜
    ' data: ç±»å‹ç‰¹å®šæ•°æ®JSON
    '   åŠ¨æ€1: {text, topic_ids[], media_ids[], location, at_users[]}
    '   æ´»åŠ¨2: {time, location, limit, price, requirements, fee_detail}
    '   æŠ€èƒ½3: {skill_type, price_list[], rank, service_mode, heroes[]}
    ' status: å†…å®¹çŠ¶æ€(0=è‰ç¨¿,1=å‘å¸ƒ,2=ä¸‹æ¶,3=åˆ é™¤)
    ' created_at: åˆ›å»ºæ—¶é—´
    '
    ' ç”¨æˆ·è¡Œä¸ºç¤ºä¾‹ï¼š
    ' - å‘å¸ƒåŠ¨æ€ï¼šINSERT (type=1, data={text, topic_ids, media_ids})
    ' - å‘å¸ƒç»„å±€ï¼šINSERT (type=2, data={time, location, limit, price})
    ' - æ·»åŠ æŠ€èƒ½ï¼šINSERT (type=3, data={skill_type, price_list})
    ' - ç¼–è¾‘å†…å®¹ï¼šUPDATE data JSONå­—æ®µ
    ' - ä¸‹æ¶å†…å®¹ï¼šUPDATE status=2
}

class ContentAction {
    + id : Long
    + content_id : Long
    + user_id : Long
    + action : Integer
    + data : JSON
    + created_at : DateTime
    --
    ' å†…å®¹è¡Œä¸ºç»Ÿä¸€è¡¨(æ ¸å¿ƒäº’åŠ¨è¡¨)
    ' id: è¡Œä¸ºè®°å½•ID
    ' content_id: å…³è”å†…å®¹ID
    ' user_id: æ“ä½œç”¨æˆ·ID
    ' action: è¡Œä¸ºç±»å‹
    '   1=ç‚¹èµ(data=null)
    '   2=è¯„è®º(data={comment, reply_to})
    '   3=æ”¶è—(data=null)
    '   4=åˆ†äº«(data={platform, share_count})
    '   5=è¯„ä»·(data={rating, comment})
    '   6=æŠ¥å(data={name, phone, gender, remark})
    ' data: è¡Œä¸ºæ‰©å±•æ•°æ®JSON
    ' created_at: è¡Œä¸ºæ—¶é—´
    '
    ' ç”¨æˆ·è¡Œä¸ºç¤ºä¾‹ï¼š
    ' - ç‚¹èµåŠ¨æ€ï¼šINSERT (content_id, user_id, action=1)
    ' - å‘è¡¨è¯„è®ºï¼šINSERT (action=2, data={comment:'...'})
    ' - å›å¤è¯„è®ºï¼šINSERT (action=2, data={comment, reply_to:123})
    ' - æ´»åŠ¨æŠ¥åï¼šINSERT (action=6, data={name, phone})
}

class UserRelation {
    + id : Long
    + user_id : Long
    + target_id : Long
    + type : Integer
    + created_at : DateTime
    --
    ' ç”¨æˆ·å…³ç³»è¡¨
    ' id: å…³ç³»è®°å½•ID
    ' user_id: å‘èµ·ç”¨æˆ·ID
    ' target_id: ç›®æ ‡ç”¨æˆ·ID
    ' type: å…³ç³»ç±»å‹(1=å…³æ³¨,2=æ‹‰é»‘,3=åˆ†ç»„)
    ' created_at: å»ºç«‹å…³ç³»æ—¶é—´
}

' ===== äº¤æ˜“æ¨¡å— (1è¡¨) =====

class ServiceOrder {
    + id : Long
    + buyer_id : Long
    + seller_id : Long
    + content_id : Long
    + amount : Long
    + duration : Integer
    + status : Integer
    + data : JSON
    + created_at : DateTime
    --
    ' æœåŠ¡è®¢å•è¡¨(æ¸¸æˆé™ªç©+ç”Ÿæ´»æœåŠ¡+æ´»åŠ¨æŠ¥å)
    ' id: è®¢å•å”¯ä¸€ID
    ' buyer_id: ä¹°å®¶ç”¨æˆ·ID
    ' seller_id: å–å®¶ç”¨æˆ·ID
    ' content_id: å…³è”Content(type=2æ´»åŠ¨/type=3æŠ€èƒ½)
    ' amount: è®¢å•é‡‘é¢(åˆ†)
    ' duration: æœåŠ¡æ—¶é•¿(å°æ—¶)
    ' status: è®¢å•çŠ¶æ€
    '   0=å¾…ä»˜æ¬¾
    '   1=å·²ä»˜æ¬¾
    '   2=æœåŠ¡ä¸­
    '   3=å·²å®Œæˆ
    '   4=å·²å–æ¶ˆ
    '   5=å·²é€€æ¬¾
    ' data: è®¢å•æ‰©å±•ä¿¡æ¯JSON
    '   {service_type, appointment_time, 
    '    buyer_note, seller_note, status_history[]}
    ' created_at: ä¸‹å•æ—¶é—´
    '
    ' ç”¨æˆ·è¡Œä¸ºç¤ºä¾‹ï¼š
    ' - ä¸‹å•é™ªç©ï¼šINSERT (buyer=me, seller=456, amount=1500)
    ' - æŠ¥åæ´»åŠ¨ï¼šINSERT (buyer=me, seller=å‘èµ·äºº, amount=6800)
    ' - æ”¯ä»˜è®¢å•ï¼šUserWalletæ‰£æ¬¾â†’status=0â†’1
    ' - å®ŒæˆæœåŠ¡ï¼šstatus=3â†’è¯„ä»·ContentAction
    ' - è®¢å•èŠå¤©ï¼šChatConversation(type=4, metadata.order_id)
}

' ===== è¯é¢˜æ ‡ç­¾æ¨¡å— (2è¡¨) =====

class Topic {
    + id : Long
    + name : String
    + description : String
    + cover_url : String
    + creator_id : Long
    + stats : JSON
    + status : Integer
    + created_at : DateTime
    --
    ' è¯é¢˜æ ‡ç­¾è¡¨(å†…å®¹èšåˆæ ¸å¿ƒ)
    ' id: è¯é¢˜å”¯ä¸€ID
    ' name: è¯é¢˜åç§°(å”¯ä¸€,å¦‚#S10å…¨çƒæ€»å†³èµ›)
    ' description: è¯é¢˜æè¿°
    ' cover_url: è¯é¢˜å°é¢å›¾(å¯é€‰)
    ' creator_id: åˆ›å»ºè€…ID(é¦–æ¬¡ä½¿ç”¨è¯¥è¯é¢˜çš„ç”¨æˆ·)
    ' stats: ç»Ÿè®¡æ•°æ®JSON(æ¯å°æ—¶æ›´æ–°)
    '   {participant_count: 12000,
    '    post_count: 35000,
    '    heat_score: 98,
    '    trend: 'rising',
    '    top_contributors: [123,456],
    '    last_update: '2025-10-12 10:00'}
    ' status: è¯é¢˜çŠ¶æ€(0=ç¦ç”¨,1=æ­£å¸¸,2=çƒ­é—¨,3=æ¨è)
    ' created_at: åˆ›å»ºæ—¶é—´
    '
    ' ç”¨æˆ·è¡Œä¸ºç¤ºä¾‹ï¼š
    ' - åˆ›å»ºè¯é¢˜ï¼šå‘å¸ƒåŠ¨æ€æ—¶è¾“å…¥æ–°è¯é¢˜â†’è‡ªåŠ¨åˆ›å»º
    ' - ä½¿ç”¨è¯é¢˜ï¼šå‘å¸ƒåŠ¨æ€â†’é€‰æ‹©è¯é¢˜â†’data.topic_ids[]
    ' - æŸ¥çœ‹è¯é¢˜ï¼šç‚¹å‡»#è¯é¢˜â†’æŸ¥è¯¢è¯¥è¯é¢˜æ‰€æœ‰åŠ¨æ€
    ' - æœç´¢è¯é¢˜ï¼šæœç´¢æ¡†â†’æ¨¡ç³ŠåŒ¹é…è¯é¢˜åç§°
    ' - çƒ­é—¨æ¦œå•ï¼šORDER BY stats.heat_score DESC
}

class UserTag {
    + id : Long
    + user_id : Long
    + tag_type : Integer
    + tag_value : String
    + metadata : JSON
    + created_at : DateTime
    --
    ' ç”¨æˆ·æ ‡ç­¾è¡¨(å¤šç»´åº¦ç”¨æˆ·ç”»åƒ)
    ' id: æ ‡ç­¾è®°å½•ID
    ' user_id: ç”¨æˆ·ID
    ' tag_type: æ ‡ç­¾ç±»å‹
    '   1=æŠ€èƒ½æ ‡ç­¾(ç‹è€…è£è€€/æ¢åº—/æŒ‰æ‘©/å°çƒ/Kæ­Œ)
    '   2=èŒä¸šæ ‡ç­¾(æ¨¡ç‰¹/å­¦ç”Ÿ/è‡ªç”±èŒä¸š,æœ€å¤š5ä¸ª)
    '   3=è®¤è¯æ ‡ç­¾(å®åè®¤è¯/å¤§ç¥è®¤è¯/å•†å®¶è®¤è¯)
    '   4=å…´è¶£æ ‡ç­¾(æ¸¸æˆ/è¿åŠ¨/å¨±ä¹åå¥½)
    ' tag_value: æ ‡ç­¾å€¼(å…·ä½“æ ‡ç­¾åç§°)
    ' metadata: æ ‡ç­¾æ‰©å±•ä¿¡æ¯JSON
    '   æŠ€èƒ½æ ‡ç­¾: {level:'è£è€€ç‹è€…', verified:true, score:95}
    '   èŒä¸šæ ‡ç­¾: {industry:'å¨±ä¹', experience:3}
    '   è®¤è¯æ ‡ç­¾: {verify_time:'2025-10-01', cert_no:'***'}
    ' created_at: åˆ›å»ºæ—¶é—´
    '
    ' ç”¨æˆ·è¡Œä¸ºç¤ºä¾‹ï¼š
    ' - æ·»åŠ æŠ€èƒ½ï¼šINSERT (tag_type=1, tag_value='ç‹è€…è£è€€')
    ' - æ·»åŠ èŒä¸šï¼šINSERT (tag_type=2, tag_value='æ¨¡ç‰¹')
    ' - åˆ é™¤èŒä¸šï¼šDELETE WHERE tag_type=2 AND tag_value='xxx'
    ' - è·å¾—è®¤è¯ï¼šINSERT (tag_type=3, tag_value='å®åè®¤è¯')
    ' - æŠ€èƒ½ç­›é€‰ï¼šWHERE tag_type=1 AND tag_value='ç‹è€…è£è€€'
}

' ===== åª’ä½“æ–‡ä»¶æ¨¡å— (1è¡¨) =====

class Media {
    + id : Long
    + uploader_id : Long
    + file_type : Integer
    + file_url : String
    + thumbnail_url : String
    + metadata : JSON
    + status : Integer
    + created_at : DateTime
    --
    ' åª’ä½“æ–‡ä»¶è¡¨(ç»Ÿä¸€ç®¡ç†+CDNåŠ é€Ÿ)
    ' id: æ–‡ä»¶å”¯ä¸€ID
    ' uploader_id: ä¸Šä¼ è€…ID
    ' file_type: æ–‡ä»¶ç±»å‹
    '   1=å›¾ç‰‡(JPG/PNG/GIF/WebP,æœ€å¤§5MB)
    '   2=è§†é¢‘(MP4/MOV,æœ€å¤§100MB,5åˆ†é’Ÿ)
    '   3=éŸ³é¢‘(MP3/AAC,æœ€å¤§10MB,60ç§’)
    ' file_url: CDNæ–‡ä»¶è®¿é—®URL
    ' thumbnail_url: ç¼©ç•¥å›¾URL(è‡ªåŠ¨ç”Ÿæˆ)
    ' metadata: æ–‡ä»¶æ‰©å±•ä¿¡æ¯JSON
    '   å›¾ç‰‡: {size:524288, width:1920, height:1080, format:'jpg'}
    '   è§†é¢‘: {size:10485760, duration:120, format:'mp4'}
    '   éŸ³é¢‘: {size:1048576, duration:60, waveform:[...]}
    ' status: æ–‡ä»¶çŠ¶æ€(0=å·²åˆ é™¤,1=æ­£å¸¸,2=å®¡æ ¸ä¸­,3=è¿è§„)
    ' created_at: ä¸Šä¼ æ—¶é—´
    '
    ' ç”¨æˆ·è¡Œä¸ºç¤ºä¾‹ï¼š
    ' - ä¸Šä¼ å¤´åƒï¼šæ‹ç…§â†’è£å‰ªâ†’å‹ç¼©â†’INSERTâ†’UserProfile.avatar
    ' - å‘å¸ƒåŠ¨æ€ï¼šé€‰9å¼ å›¾â†’æ‰¹é‡INSERTâ†’Content.data.media_ids[]
    ' - å‘é€å›¾ç‰‡ï¼šèŠå¤©ä¸Šä¼ â†’INSERTâ†’ChatMessage.media_data.media_id
    ' - è¯­éŸ³è¯•å¬ï¼šå½•éŸ³â†’INSERTâ†’Content.data.voice_sample_id
    ' - æŸ¥çœ‹å¤§å›¾ï¼šSELECT file_urlâ†’CDNåŠ é€Ÿä¸‹è½½
}

' ===== é€šçŸ¥æ¨é€æ¨¡å— (1è¡¨) =====

class Notification {
    + id : Long
    + user_id : Long
    + type : Integer
    + title : String
    + content : String
    + data : JSON
    + is_read : Boolean
    + created_at : DateTime
    --
    ' é€šçŸ¥æ¶ˆæ¯è¡¨(æ¶ˆæ¯é¡µ4ä¸ªåŠŸèƒ½å¡ç‰‡)
    ' id: é€šçŸ¥å”¯ä¸€ID
    ' user_id: æ¥æ”¶ç”¨æˆ·ID(é€šçŸ¥å¯¹è±¡)
    ' type: é€šçŸ¥ç±»å‹
    '   1=ç‚¹èµé€šçŸ¥â†’"èµå’Œæ”¶è—"å¡ç‰‡
    '   2=è¯„è®ºé€šçŸ¥â†’"è¯„è®º"å¡ç‰‡
    '   3=å…³æ³¨é€šçŸ¥â†’"ç²‰ä¸"å¡ç‰‡
    '   4=ç³»ç»Ÿé€šçŸ¥â†’"ç³»ç»Ÿé€šçŸ¥"å¡ç‰‡
    ' title: é€šçŸ¥æ ‡é¢˜(å¦‚"å®Œå–„ä¸ªäººèµ„æ–™")
    ' content: é€šçŸ¥å†…å®¹(å¦‚"ç”¨æˆ·123ç‚¹èµäº†ä½ çš„åŠ¨æ€")
    ' data: æ‰©å±•æ•°æ®JSON
    '   {sender_id:456, sender_name:'ç”¨æˆ·123',
    '    content_id:789, content_preview:'è¯·ä½ ä»¬çœ‹é›ª',
    '    action_type:'like', thumbnail:'https://...'}
    ' is_read: æ˜¯å¦å·²è¯»(0=æœªè¯»æ˜¾ç¤ºè§’æ ‡,1=å·²è¯»)
    ' created_at: é€šçŸ¥æ—¶é—´
    '
    ' ç”¨æˆ·è¡Œä¸ºç¤ºä¾‹ï¼š
    ' - ç‚¹èµè§¦å‘ï¼šContentActionç‚¹èµâ†’INSERT Notification(type=1)
    ' - è¯„è®ºè§¦å‘ï¼šContentActionè¯„è®ºâ†’INSERT Notification(type=2)
    ' - å…³æ³¨è§¦å‘ï¼šUserRelationå…³æ³¨â†’INSERT Notification(type=3)
    ' - æŸ¥çœ‹é€šçŸ¥ï¼šæ¶ˆæ¯é¡µâ†’ç‚¹å‡»å¡ç‰‡â†’æŸ¥è¯¢å¯¹åº”type
    ' - æ ‡è®°å·²è¯»ï¼šæŸ¥çœ‹é€šçŸ¥â†’UPDATE is_read=1
    ' - æ¸…ç©ºé€šçŸ¥ï¼šä¸€é”®æ¸…é™¤â†’DELETE WHERE type=x
}

' ===== å®‰å…¨å®¡æ ¸æ¨¡å— (1è¡¨) =====

class Report {
    + id : Long
    + reporter_id : Long
    + target_id : Long
    + target_type : Integer
    + reason : Integer
    + description : String
    + evidence : JSON
    + status : Integer
    + created_at : DateTime
    --
    ' ä¸¾æŠ¥è®°å½•è¡¨(24å°æ—¶å¤„ç†æ‰¿è¯º)
    ' id: ä¸¾æŠ¥è®°å½•ID
    ' reporter_id: ä¸¾æŠ¥äººID(ä¸¥æ ¼ä¿å¯†)
    ' target_id: è¢«ä¸¾æŠ¥ç›®æ ‡ID
    ' target_type: ç›®æ ‡ç±»å‹
    '   1=ä¸¾æŠ¥ç”¨æˆ·(User)
    '   2=ä¸¾æŠ¥å†…å®¹(Content)
    '   3=ä¸¾æŠ¥è¯„è®º(ContentAction)
    ' reason: ä¸¾æŠ¥åŸå› (6å¤§ç±»)
    '   1=åƒåœ¾ä¿¡æ¯(å¹¿å‘Š/è¥é”€)
    '   2=ä¸å½“å†…å®¹(è‰²æƒ…/æš´åŠ›)
    '   3=ä¾µæƒå†…å®¹(ç›—ç”¨ä½œå“)
    '   4=è™šå‡ä¿¡æ¯(è°£è¨€)
    '   5=éªšæ‰°ä»–äºº(æ¶æ„@)
    '   6=å…¶ä»–(å…¶ä»–è¿è§„)
    ' description: è¯¦ç»†è¯´æ˜(æœ€å¤š500å­—)
    ' evidence: è¯æ®ææ–™JSON
    '   {screenshots:['url1','url2'], 
    '    description:'è¯¦ç»†è¯´æ˜', category:'è‰²æƒ…'}
    ' status: å¤„ç†çŠ¶æ€
    '   0=å¾…å¤„ç† 1=å¤„ç†ä¸­ 2=å·²å¤„ç† 3=å·²é©³å›
    ' created_at: ä¸¾æŠ¥æ—¶é—´
    '
    ' ç”¨æˆ·è¡Œä¸ºç¤ºä¾‹ï¼š
    ' - ä¸¾æŠ¥åŠ¨æ€ï¼šæ›´å¤šèœå•â†’ä¸¾æŠ¥â†’é€‰ç†ç”±â†’å¡«è¯´æ˜â†’æäº¤
    ' - ä¸¾æŠ¥ç”¨æˆ·ï¼šç”¨æˆ·è¯¦æƒ…â†’ä¸¾æŠ¥â†’ä¸Šä¼ æˆªå›¾â†’æäº¤
    ' - æŸ¥çœ‹è¿›åº¦ï¼šæˆ‘çš„ä¸¾æŠ¥â†’æŸ¥è¯¢statusçŠ¶æ€
    ' - ç®¡ç†å‘˜å¤„ç†ï¼šå®¡æ ¸â†’æ›´æ–°statusâ†’é€šçŸ¥ç»“æœ
}

' ===== æœç´¢å†å²æ¨¡å— (1è¡¨) =====

class SearchHistory {
    + id : Long
    + user_id : Long
    + keyword : String
    + search_type : Integer
    + result_count : Integer
    + created_at : DateTime
    --
    ' æœç´¢å†å²è¡¨(æœ€å¤š10æ¡,æ™ºèƒ½æ¨è)
    ' id: æœç´¢è®°å½•ID
    ' user_id: æœç´¢ç”¨æˆ·ID
    ' keyword: æœç´¢å…³é”®è¯(å¦‚"ç‹è€…è£è€€")
    ' search_type: æœç´¢ç±»å‹
    '   1=ç”¨æˆ·æœç´¢(æœç´¢æ˜µç§°/ID)
    '   2=å†…å®¹æœç´¢(æœç´¢åŠ¨æ€)
    '   3=è¯é¢˜æœç´¢(æœç´¢#è¯é¢˜)
    ' result_count: æœç´¢ç»“æœæ•°é‡(ç”¨äºä¼˜åŒ–)
    ' created_at: æœç´¢æ—¶é—´
    '
    ' ç”¨æˆ·è¡Œä¸ºç¤ºä¾‹ï¼š
    ' - æœç´¢ç”¨æˆ·ï¼šè¾“å…¥å…³é”®è¯â†’æœç´¢â†’INSERTè®°å½•
    ' - æ˜¾ç¤ºå†å²ï¼šæœç´¢é¡µâ†’æ˜¾ç¤ºæœ€è¿‘10æ¡â†’ORDER BY created_at DESC
    ' - ç‚¹å‡»å†å²ï¼šç‚¹å‡»å†å²æ ‡ç­¾â†’å¿«é€Ÿæœç´¢
    ' - åˆ é™¤å†å²ï¼šé•¿æŒ‰â†’åˆ é™¤å•æ¡/ä¸€é”®æ¸…ç©ºå…¨éƒ¨
    ' - çƒ­é—¨æœç´¢ï¼šGROUP BY keywordâ†’COUNTâ†’çƒ­è¯ç»Ÿè®¡
    ' - è‡ªåŠ¨æ¸…ç†ï¼šè¶…è¿‡10æ¡â†’DELETEæœ€æ—©è®°å½•
}

' ===== èŠå¤©æ¨¡å— (3è¡¨) =====

class ChatConversation {
    + id : Long
    + type : Integer
    + title : String
    + creator_id : Long
    + metadata : JSON
    + status : Integer
    + created_at : DateTime
    + updated_at : DateTime
    --
    ' èŠå¤©ä¼šè¯è¡¨(ç§èŠ/ç¾¤èŠ/è®¢å•/æ´»åŠ¨)
    ' id: ä¼šè¯å”¯ä¸€ID(é›ªèŠ±ID)
    ' type: ä¼šè¯ç±»å‹
    '   1=ç§èŠä¼šè¯(ä¸€å¯¹ä¸€èŠå¤©)
    '   2=ç¾¤èŠä¼šè¯(æ´»åŠ¨ç¾¤/æ™®é€šç¾¤)
    '   3=ç³»ç»Ÿé€šçŸ¥(ç³»ç»Ÿæ¶ˆæ¯)
    '   4=è®¢å•ä¼šè¯(ä¹°å–åŒæ–¹ä¸“å±)
    ' title: ä¼šè¯æ ‡é¢˜
    '   ç§èŠä¸ºç©º,ç¾¤èŠå¦‚"Kæ­Œæ´»åŠ¨ç¾¤"
    ' creator_id: åˆ›å»ºè€…ID(ç¾¤ä¸»/å‘èµ·äºº)
    ' metadata: æ‰©å±•ä¿¡æ¯JSON
    '   ç§èŠ: {muted:false, pinned:true}
    '   ç¾¤èŠ: {member_limit:6, activity_id:123}
    '   è®¢å•: {order_id:456, service_type:'game'}
    ' status: ä¼šè¯çŠ¶æ€(0=å·²è§£æ•£,1=æ­£å¸¸,2=å·²å½’æ¡£)
    ' created_at: åˆ›å»ºæ—¶é—´
    ' updated_at: æœ€åæ´»è·ƒæ—¶é—´(æœ€æ–°æ¶ˆæ¯æ—¶é—´)
    '
    ' ç”¨æˆ·è¡Œä¸ºç¤ºä¾‹ï¼š
    ' - å‘èµ·ç§èŠï¼šç‚¹å‡»ç§ä¿¡â†’åˆ›å»ºä¼šè¯(type=1)
    ' - æ´»åŠ¨ç¾¤èŠï¼šæŠ¥åæˆåŠŸâ†’è‡ªåŠ¨åˆ›å»º(type=2)
    ' - è®¢å•ä¼šè¯ï¼šä¸‹å•æˆåŠŸâ†’è‡ªåŠ¨åˆ›å»º(type=4)
    ' - ç½®é¡¶å¯¹è¯ï¼šmetadata.pinned=true
    ' - å…æ‰“æ‰°ï¼šmetadata.muted=true
}

class ChatMessage {
    + id : Long
    + conversation_id : Long
    + sender_id : Long
    + message_type : Integer
    + content : String
    + media_data : JSON
    + reply_to_id : Long
    + status : Integer
    + created_at : DateTime
    --
    ' èŠå¤©æ¶ˆæ¯è¡¨(æ”¯æŒå¤šåª’ä½“+å¼•ç”¨+ç‚¹èµ)
    ' id: æ¶ˆæ¯å”¯ä¸€ID
    ' conversation_id: æ‰€å±ä¼šè¯ID
    ' sender_id: å‘é€è€…ID(NULL=ç³»ç»Ÿæ¶ˆæ¯)
    ' message_type: æ¶ˆæ¯ç±»å‹
    '   1=æ–‡æœ¬æ¶ˆæ¯
    '   2=å›¾ç‰‡æ¶ˆæ¯(æ”¯æŒç‚¹èµåŠŸèƒ½)
    '   3=è¯­éŸ³æ¶ˆæ¯(60ç§’é™åˆ¶)
    '   4=è§†é¢‘æ¶ˆæ¯(5åˆ†é’Ÿé™åˆ¶)
    '   5=æ–‡ä»¶æ¶ˆæ¯
    '   6=ç³»ç»Ÿé€šçŸ¥
    ' content: æ¶ˆæ¯å†…å®¹(æ–‡æœ¬/é…æ–‡/ç³»ç»Ÿé€šçŸ¥æ–‡æœ¬)
    ' media_data: åª’ä½“æ•°æ®JSON
    '   å›¾ç‰‡: {media_id:789, caption:'è¯·ä½ ä»¬çœ‹é›ª',
    '         like_count:88, like_users:[111,222]}
    '   è¯­éŸ³: {media_id:790, duration:30, waveform:[...]}
    '   è§†é¢‘: {media_id:791, duration:120, thumbnail:'...'}
    ' reply_to_id: å›å¤çš„æ¶ˆæ¯ID(å¼•ç”¨å›å¤)
    ' status: æ¶ˆæ¯çŠ¶æ€(0=å·²åˆ é™¤,1=æ­£å¸¸,2=å·²æ’¤å›)
    ' created_at: å‘é€æ—¶é—´
    '
    ' ç”¨æˆ·è¡Œä¸ºç¤ºä¾‹ï¼š
    ' - å‘æ–‡å­—ï¼šINSERT (type=1, content='ä½ å¥½')
    ' - å‘å›¾ç‰‡ï¼šMediaä¸Šä¼ â†’INSERT (type=2, media_data={media_id})
    ' - ç‚¹èµå›¾ç‰‡ï¼šUPDATE media_data.like_count++, like_users.push(user_id)
    ' - å‘è¯­éŸ³ï¼šå½•éŸ³60sâ†’Mediaä¸Šä¼ â†’INSERT (type=3)
    ' - å›å¤æ¶ˆæ¯ï¼šé•¿æŒ‰â†’å›å¤â†’INSERT (reply_to_id=123)
    ' - æ’¤å›æ¶ˆæ¯ï¼š2åˆ†é’Ÿå†…â†’UPDATE status=2
}

class ChatParticipant {
    + id : Long
    + conversation_id : Long
    + user_id : Long
    + role : Integer
    + join_time : DateTime
    + last_read_time : DateTime
    + status : Integer
    --
    ' ä¼šè¯å‚ä¸è€…è¡¨(æˆå‘˜ç®¡ç†+æœªè¯»è®¡ç®—)
    ' id: å‚ä¸è®°å½•ID
    ' conversation_id: ä¼šè¯ID
    ' user_id: å‚ä¸ç”¨æˆ·ID
    ' role: è§’è‰²æƒé™
    '   1=æ™®é€šæˆå‘˜
    '   2=ç®¡ç†å‘˜(å¯è¸¢äºº)
    '   3=ç¾¤ä¸»(å¯è§£æ•£ç¾¤)
    ' join_time: åŠ å…¥æ—¶é—´
    ' last_read_time: æœ€åå·²è¯»æ—¶é—´
    '   ç”¨äºè®¡ç®—æœªè¯»ï¼šCOUNTæ¶ˆæ¯WHERE created_at>last_read_time
    ' status: å‚ä¸çŠ¶æ€(0=å·²é€€å‡º,1=æ­£å¸¸,2=å·²ç¦è¨€)
    '
    ' ç”¨æˆ·è¡Œä¸ºç¤ºä¾‹ï¼š
    ' - åŠ å…¥ä¼šè¯ï¼šINSERT (conversation_id, user_id, role=1)
    ' - é˜…è¯»æ¶ˆæ¯ï¼šUPDATE last_read_time=NOW()
    ' - è®¡ç®—æœªè¯»ï¼šCOUNTæ¶ˆæ¯WHERE created_at>last_read_time
    ' - é€€å‡ºç¾¤èŠï¼šUPDATE status=0
    ' - ç¾¤ä¸»è¸¢äººï¼šUPDATE status=0 WHERE user_id=xxx
}

' ==========================================
' ğŸ”— UMLå…³ç³»å®šä¹‰ - ç¬¦åˆPlantUMLæ ‡å‡†è¯­æ³•
' ==========================================

' ğŸ“Œ PlantUMLå…³ç³»ç¬¦å·è¯´æ˜ï¼š
' *--  : ç»„åˆ(Composition) - å®å¿ƒè±å½¢ï¼Œå¼ºä¾èµ–
' o--  : èšåˆ(Aggregation) - ç©ºå¿ƒè±å½¢ï¼Œå¼±ä¾èµ–  
' --   : å…³è”(Association) - å®çº¿ï¼Œç»“æ„åŒ–å…³ç³»
' ..>  : ä¾èµ–(Dependency) - è™šçº¿ç®­å¤´ï¼Œä½¿ç”¨å…³ç³»
' <|-- : ç»§æ‰¿(Inheritance) - ä¸‰è§’ç®­å¤´ï¼Œæ³›åŒ–å…³ç³»
' <|.. : å®ç°(Realization) - è™šçº¿ä¸‰è§’ï¼Œæ¥å£å®ç°

' ğŸ“Œ å¤šé‡æ€§è¡¨ç¤ºè¯´æ˜ï¼š
' "1"     : æ°å¥½ä¸€ä¸ª
' "0..1"  : é›¶ä¸ªæˆ–ä¸€ä¸ª  
' "0..*"  : é›¶ä¸ªæˆ–å¤šä¸ª
' "1..*"  : ä¸€ä¸ªæˆ–å¤šä¸ª

' ===== ç»„åˆå…³ç³» (Composition) *-- =====
' ğŸ”¸ ç‰¹å¾ï¼šå®å¿ƒè±å½¢ï¼Œç”Ÿå‘½å‘¨æœŸç»‘å®š
' ğŸ”¸ è¯­ä¹‰ï¼šæ•´ä½“-éƒ¨åˆ†ï¼Œéƒ¨åˆ†ä¸èƒ½ç‹¬ç«‹å­˜åœ¨
' ğŸ”¸ åˆ é™¤ç­–ç•¥ï¼šCASCADE DELETE

' ç”¨æˆ·æ ¸å¿ƒç»„åˆå…³ç³»
User "1" *-- "1" UserProfile : "æ‹¥æœ‰èµ„æ–™\nç”Ÿå‘½å‘¨æœŸç»‘å®š"
User "1" *-- "1" UserWallet : "æ‹¥æœ‰é’±åŒ…\nå¼ºä¾èµ–å…³ç³»"

' èŠå¤©æ¨¡å—ç»„åˆå…³ç³»
ChatConversation "1" *-- "0..*" ChatMessage : "ä¼šè¯æ¶ˆæ¯\nç”Ÿå‘½å‘¨æœŸç»‘å®š"
ChatConversation "1" *-- "1..*" ChatParticipant : "ä¼šè¯å‚ä¸è€…\nå¼ºä¾èµ–å…³ç³»"

' ===== èšåˆå…³ç³» (Aggregation) o-- =====  
' ğŸ”¸ ç‰¹å¾ï¼šç©ºå¿ƒè±å½¢ï¼Œå¼±ä¾èµ–å…³ç³»
' ğŸ”¸ è¯­ä¹‰ï¼šæ•´ä½“-éƒ¨åˆ†ï¼Œéƒ¨åˆ†å¯ç‹¬ç«‹å­˜åœ¨
' ğŸ”¸ åˆ é™¤ç­–ç•¥ï¼šSET NULL æˆ– RESTRICT

' ç”¨æˆ·ä¸šåŠ¡èšåˆå…³ç³»
User "1" o-- "0..*" Transaction : "äº§ç”Ÿäº¤æ˜“\nå†å²è®°å½•ä¿ç•™"
User "1" o-- "0..*" Content : "åˆ›å»ºå†…å®¹\nå¯åŒ¿ååŒ–ä¿å­˜"
Content "1" o-- "0..*" ContentAction : "å†…å®¹äº’åŠ¨\nè¡Œä¸ºè®°å½•"

' ===== å…³è”å…³ç³» (Association) -- =====
' ğŸ”¸ ç‰¹å¾ï¼šå®çº¿è¿æ¥ï¼Œç»“æ„åŒ–å…³ç³»
' ğŸ”¸ è¯­ä¹‰ï¼šç±»ä¹‹é—´çš„å¼•ç”¨å…³ç³»
' ğŸ”¸ åˆ é™¤ç­–ç•¥ï¼šRESTRICT æˆ–ä¸šåŠ¡é€»è¾‘å¤„ç†

' ç”¨æˆ·è¡Œä¸ºå…³è”
User "1" -- "0..*" ContentAction : "ç”¨æˆ·æ“ä½œ\nè¡Œä¸ºè¿½è¸ª"

' èŠå¤©ç”¨æˆ·å…³è”
User "åˆ›å»ºè€…\ncreator" -- "0..*" ChatConversation : "åˆ›å»ºä¼šè¯\nç¾¤ä¸»æƒé™"
User "å‘é€è€…\nsender" -- "0..*" ChatMessage : "å‘é€æ¶ˆæ¯\nå†…å®¹åˆ›å»º"
User "å‚ä¸è€…\nparticipant" -- "0..*" ChatParticipant : "åŠ å…¥ä¼šè¯\næˆå‘˜èº«ä»½"

' ===== è‡ªå…³è”å…³ç³» (Self Association) =====
' ğŸ”¸ ç‰¹å¾ï¼šä¸€ä¸ªç±»ä¸è‡ªèº«å»ºç«‹å…³ç³»
' ğŸ”¸ åº”ç”¨ï¼šç”¨æˆ·å…³æ³¨ã€ç»„ç»‡å±‚çº§ã€æ¶ˆæ¯å›å¤ç­‰
' ğŸ”¸ å®ç°ï¼šåŒä¸€è¡¨ä¸­çš„ä¸¤ä¸ªå¤–é”®å­—æ®µ

' ç”¨æˆ·å…³ç³»è‡ªå…³è”
User "å‘èµ·è€…\nsource" -- "0..*" UserRelation : "ä¸»åŠ¨å»ºç«‹\nå…³ç³»å‘èµ·"
User "ç›®æ ‡è€…\ntarget" -- "0..*" UserRelation : "è¢«åŠ¨æ¥å—\nå…³ç³»ç›®æ ‡"

' æ¶ˆæ¯å›å¤è‡ªå…³è”
ChatMessage "åŸæ¶ˆæ¯\noriginal" -- "0..*" ChatMessage : "å›å¤æ¶ˆæ¯\nå¼•ç”¨å…³ç³»"

' ===== å¤šè§’è‰²å…³è” (Multi-Role Association) =====
' ğŸ”¸ ç‰¹å¾ï¼šåŒä¸€ä¸ªç±»åœ¨å…³ç³»ä¸­æ‰®æ¼”ä¸åŒè§’è‰²
' ğŸ”¸ å®ç°ï¼šä½¿ç”¨è§’è‰²åç§°åŒºåˆ†ä¸åŒçš„å…³ç³»ç«¯ç‚¹

' è®¢å•å¤šè§’è‰²å…³è”
User "ä¹°å®¶\nbuyer" -- "0..*" ServiceOrder : "ä¸‹å•è´­ä¹°\næ¶ˆè´¹è€…è§’è‰²"
User "å–å®¶\nseller" -- "0..*" ServiceOrder : "æä¾›æœåŠ¡\næœåŠ¡è€…è§’è‰²"

' ===== ä¸šåŠ¡å…³è” (Business Association) =====
' ğŸ”¸ ç‰¹å¾ï¼šè¡¨ç¤ºä¸šåŠ¡å±‚é¢çš„å¼•ç”¨å…³ç³»
' ğŸ”¸ ç›®çš„ï¼šè¿æ¥ä¸åŒä¸šåŠ¡é¢†åŸŸçš„å®ä½“

' è®¢å•å†…å®¹å…³è”
Content "æŠ€èƒ½æœåŠ¡\nskill" -- "0..*" ServiceOrder : "è®¢å•å†…å®¹\næœåŠ¡æ ‡çš„"

' ===== è¯é¢˜ä¸å†…å®¹å…³è” =====
' ğŸ”¸ å†…å®¹å¯å…³è”å¤šä¸ªè¯é¢˜æ ‡ç­¾

Content "åˆ›å»ºè€…\nauthor" -- "0..*" Topic : "ä½¿ç”¨è¯é¢˜\nè¯é¢˜æ ‡ç­¾"
Topic "1" o-- "0..*" Content : "è¯é¢˜åŠ¨æ€\nå†…å®¹èšåˆ"

' ===== ç”¨æˆ·æ ‡ç­¾å…³è” =====
' ğŸ”¸ ç”¨æˆ·æ‹¥æœ‰å¤šç§æ ‡ç­¾ï¼ˆæŠ€èƒ½ã€èŒä¸šã€è®¤è¯ç­‰ï¼‰

User "1" o-- "0..*" UserTag : "ç”¨æˆ·æ ‡ç­¾\nå¤šç»´æ ‡ç­¾"

' ===== åª’ä½“æ–‡ä»¶å…³è” =====
' ğŸ”¸ å†…å®¹å’Œæ¶ˆæ¯éƒ½å¯ä»¥å…³è”åª’ä½“æ–‡ä»¶

User "ä¸Šä¼ è€…\nuploader" -- "0..*" Media : "ä¸Šä¼ æ–‡ä»¶\nåª’ä½“èµ„æº"
Content "å†…å®¹åª’ä½“\ncontent" -- "0..*" Media : "å…³è”åª’ä½“\nå›¾ç‰‡è§†é¢‘"
ChatMessage "æ¶ˆæ¯åª’ä½“\nmessage" -- "0..*" Media : "é™„ä»¶èµ„æº\nå¤šåª’ä½“"

' ===== é€šçŸ¥ç³»ç»Ÿå…³è” =====
' ğŸ”¸ ç”¨æˆ·æ¥æ”¶å„ç±»é€šçŸ¥æ¶ˆæ¯

User "æ¥æ”¶è€…\nreceiver" -- "0..*" Notification : "æ¥æ”¶é€šçŸ¥\næ¶ˆæ¯æ¨é€"
ContentAction "è§¦å‘é€šçŸ¥\ntrigger" ..> Notification : "äº’åŠ¨é€šçŸ¥\nç‚¹èµè¯„è®º"
UserRelation "è§¦å‘é€šçŸ¥\ntrigger" ..> Notification : "å…³æ³¨é€šçŸ¥\nç¤¾äº¤æé†’"

' ===== ä¸¾æŠ¥ç³»ç»Ÿå…³è” =====
' ğŸ”¸ æ”¯æŒä¸¾æŠ¥ç”¨æˆ·ã€å†…å®¹ã€è¯„è®ºç­‰

User "ä¸¾æŠ¥äºº\nreporter" -- "0..*" Report : "æäº¤ä¸¾æŠ¥\nå®‰å…¨ç®¡ç†"
Content "è¢«ä¸¾æŠ¥\ntarget" -- "0..*" Report : "å†…å®¹ä¸¾æŠ¥\nå†…å®¹å®‰å…¨"
ContentAction "è¢«ä¸¾æŠ¥\ntarget" -- "0..*" Report : "è¯„è®ºä¸¾æŠ¥\nè¯„è®ºç®¡ç†"

' ===== æœç´¢å†å²å…³è” =====
' ğŸ”¸ è®°å½•ç”¨æˆ·æœç´¢è¡Œä¸º

User "æœç´¢è€…\nsearcher" -- "0..*" SearchHistory : "æœç´¢è®°å½•\nè¡Œä¸ºè¿½è¸ª"

' ===== è·¨æ¨¡å—ä¸šåŠ¡å…³è” =====
' ğŸ”¸ èŠå¤©ä¸è®¢å•çš„ä¸šåŠ¡æ•´åˆ
' ğŸ”¸ æ”¯æŒè®¢å•ç›¸å…³çš„èŠå¤©ä¼šè¯

ServiceOrder "1" ..> ChatConversation : "è®¢å•èŠå¤©\nä¸šåŠ¡é›†æˆ"

' ==========================================
' ğŸ“ å…³ç³»è¯´æ˜æ³¨é‡Š
' ==========================================

note right of User::UserProfile
  ç»„åˆå…³ç³»è¯´æ˜ï¼š
  â€¢ ç”¨æˆ·åˆ é™¤æ—¶èµ„æ–™å¿…é¡»åˆ é™¤
  â€¢ Profileæ— æ³•ç‹¬ç«‹å­˜åœ¨
  â€¢ æ•°æ®åº“ï¼šON DELETE CASCADE
end note

note right of User::Transaction
  èšåˆå…³ç³»è¯´æ˜ï¼š
  â€¢ ç”¨æˆ·åˆ é™¤æ—¶äº¤æ˜“è®°å½•ä¿ç•™
  â€¢ æ”¯æŒæ•°æ®å®¡è®¡å’Œåˆ†æ
  â€¢ æ•°æ®åº“ï¼šON DELETE SET NULL
end note

note bottom of UserRelation
  **è‡ªå…³è”å…³ç³»è¯´æ˜ + ç”¨æˆ·è¡Œä¸º**
  
  â€¢ user_id -> å…³ç³»å‘èµ·è€…
  â€¢ target_id -> å…³ç³»ç›®æ ‡è€…
  
  **ç”¨æˆ·è¡Œä¸ºåœºæ™¯**
  ğŸ“± å…³æ³¨ç”¨æˆ·ï¼šç”¨æˆ·è¯¦æƒ…é¡µâ†’ç‚¹å‡»å…³æ³¨æŒ‰é’®â†’type=1
     â†’ æˆ‘çš„å…³æ³¨åˆ—è¡¨ï¼šWHERE user_id=me
     â†’ æˆ‘çš„ç²‰ä¸åˆ—è¡¨ï¼šWHERE target_id=me
  ğŸ“± å–æ¶ˆå…³æ³¨ï¼šå·²å…³æ³¨çŠ¶æ€â†’ç‚¹å‡»å–æ¶ˆâ†’åˆ é™¤è®°å½•
  ğŸ“± æ‹‰é»‘ç”¨æˆ·ï¼šç”¨æˆ·è¯¦æƒ…â†’æ‹‰é»‘â†’type=2â†’å±è”½æ‰€æœ‰å†…å®¹
  ğŸ“± å…³æ³¨åˆ—è¡¨ï¼šä¸ªäººä¸»é¡µâ†’å…³æ³¨æ•°â†’æŸ¥çœ‹å…³æ³¨åˆ—è¡¨
  ğŸ“± ç²‰ä¸ç®¡ç†ï¼šä¸ªäººä¸»é¡µâ†’ç²‰ä¸æ•°â†’å…³æ³¨ç²‰ä¸(äº’å…³)
  
  **äº’ç›¸å…³æ³¨åˆ¤æ–­**
  SELECT COUNT(*)=2 FROM UserRelation
  WHERE (user_id=A AND target_id=B AND type=1)
  OR (user_id=B AND target_id=A AND type=1)
end note

note bottom of ServiceOrder
  **å¤šè§’è‰²å…³è”è¯´æ˜ + ç”¨æˆ·è¡Œä¸º**
  
  â€¢ buyer_id -> è®¢å•è´­ä¹°è€…
  â€¢ seller_id -> æœåŠ¡æä¾›è€…
  â€¢ åŒä¸€ç”¨æˆ·å¯åŒæ—¶æ˜¯ä¹°å®¶å’Œå–å®¶
  
  **ç”¨æˆ·è¡Œä¸ºåœºæ™¯**
  ğŸ“± è´­ä¹°æœåŠ¡ï¼šæµè§ˆé™ªç©å¸ˆâ†’ä¸‹å•â†’æ”¯ä»˜â†’buyerè§’è‰²
  ğŸ“± æä¾›æœåŠ¡ï¼šå‘å¸ƒæŠ€èƒ½â†’æ¥å•â†’æœåŠ¡â†’sellerè§’è‰²
  ğŸ“± æ´»åŠ¨æŠ¥åï¼šç»„å±€ä¸­å¿ƒâ†’æŠ¥åæ´»åŠ¨â†’æ”¯ä»˜â†’buyerè§’è‰²
  ğŸ“± å‘èµ·æ´»åŠ¨ï¼šå‘å¸ƒç»„å±€â†’æ”¶æ¬¾â†’ç»„ç»‡â†’sellerè§’è‰²
  ğŸ“± è®¢å•ç®¡ç†ï¼šæˆ‘çš„è®¢å•â†’æŸ¥çœ‹ä¹°å…¥/å–å‡ºè®¢å•
  ğŸ“± è®¢å•èŠå¤©ï¼šè®¢å•è¯¦æƒ…â†’è”ç³»å¯¹æ–¹â†’ä¸“å±ä¼šè¯
  
  **è§’è‰²ç»Ÿè®¡æŸ¥è¯¢**
  æˆ‘ä¹°çš„ï¼šWHERE buyer_id=me
  æˆ‘å–çš„ï¼šWHERE seller_id=me
  æ”¶å…¥ç»Ÿè®¡ï¼šSUM(amount) WHERE seller_id=me
end note

note bottom of ChatMessage
  **æ¶ˆæ¯è‡ªå…³è”è¯´æ˜ + ç”¨æˆ·è¡Œä¸º**
  
  â€¢ reply_to_id -> è¢«å›å¤çš„æ¶ˆæ¯ID
  â€¢ æ”¯æŒæ¶ˆæ¯å¼•ç”¨å’Œçº¿ç¨‹æ˜¾ç¤º
  
  **ç”¨æˆ·è¡Œä¸ºåœºæ™¯**
  ğŸ“± å›å¤æ¶ˆæ¯ï¼šé•¿æŒ‰æ¶ˆæ¯â†’ç‚¹å‡»å›å¤â†’å¼•ç”¨åŸæ¶ˆæ¯
     â†’ reply_to_idæŒ‡å‘è¢«å›å¤çš„æ¶ˆæ¯
  ğŸ“± æŸ¥çœ‹å¼•ç”¨ï¼šæ˜¾ç¤ºè¢«å›å¤æ¶ˆæ¯å†…å®¹é¢„è§ˆ
  ğŸ“± è·³è½¬å®šä½ï¼šç‚¹å‡»å¼•ç”¨â†’è·³è½¬åˆ°åŸæ¶ˆæ¯ä½ç½®
  ğŸ“± åˆ é™¤å¤„ç†ï¼šåŸæ¶ˆæ¯åˆ é™¤â†’å¼•ç”¨ä»æ˜¾ç¤º"æ¶ˆæ¯å·²åˆ é™¤"
  
  **å›¾ç‰‡æ¶ˆæ¯ç‚¹èµ(media_data JSON)**
  ğŸ“± ç‚¹èµå›¾ç‰‡ï¼šç‚¹å‡»â¤ï¸â†’media_data.like_count++
  ğŸ“± æŸ¥çœ‹ç‚¹èµï¼šæ˜¾ç¤ºç‚¹èµæ•°å’Œç‚¹èµç”¨æˆ·åˆ—è¡¨
  ğŸ“± å–æ¶ˆç‚¹èµï¼šå†æ¬¡ç‚¹å‡»â†’like_count--
end note

note right of Content::ServiceOrder
  ä¸šåŠ¡å…³è”è¯´æ˜ï¼š
  â€¢ content_id å¼•ç”¨æŠ€èƒ½æœåŠ¡å†…å®¹
  â€¢ è®¢å•åŸºäºå…·ä½“çš„æŠ€èƒ½å†…å®¹åˆ›å»º
  â€¢ æ”¯æŒæŠ€èƒ½æœåŠ¡çš„é”€å”®ç»Ÿè®¡
  â€¢ å†…å®¹ä¸‹æ¶æ—¶è®¢å•å†å²ä¿ç•™
end note

note right of ServiceOrder::ChatConversation
  è·¨æ¨¡å—ä¸šåŠ¡æ•´åˆï¼š
  â€¢ è®¢å•åˆ›å»ºåå¯è‡ªåŠ¨åˆ›å»ºèŠå¤©ä¼šè¯
  â€¢ ä¹°å–åŒæ–¹åœ¨è®¢å•ä¼šè¯ä¸­æ²Ÿé€š
  â€¢ æ”¯æŒè®¢å•çŠ¶æ€å˜æ›´é€šçŸ¥
  â€¢ æå‡ç”¨æˆ·äº¤æ˜“ä½“éªŒ
end note

note top of Topic
  **è¯é¢˜ç³»ç»Ÿæ ¸å¿ƒ + ç”¨æˆ·è¡Œä¸º**
  
  â€¢ åŠ¨æ€å†…å®¹æŒ‰è¯é¢˜èšåˆ
  â€¢ æ”¯æŒè¯é¢˜è¶‹åŠ¿åˆ†æ
  
  **ç”¨æˆ·è¡Œä¸ºåœºæ™¯**
  ğŸ“± å‘å¸ƒåŠ¨æ€ï¼šé€‰æ‹©è¯é¢˜#S10å…¨çƒæ€»å†³èµ›
  ğŸ“± æµè§ˆè¯é¢˜ï¼šç‚¹å‡»è¯é¢˜â†’æŸ¥çœ‹ç›¸å…³åŠ¨æ€èšåˆ
  ğŸ“± åˆ›å»ºè¯é¢˜ï¼šå‘å¸ƒæ—¶åˆ›å»ºæ–°è¯é¢˜æ ‡ç­¾
  ğŸ“± çƒ­é—¨æ’è¡Œï¼šæŸ¥çœ‹çƒ­é—¨è¯é¢˜æ¦œå•
  ğŸ“± è¯é¢˜æœç´¢ï¼šæœç´¢æ¡†æœç´¢è¯é¢˜å…³é”®è¯
  
  **stats JSONå®æ—¶ç»Ÿè®¡**
  {
    participant_count: 12000,  â† å‚ä¸äººæ•°
    post_count: 35000,         â† åŠ¨æ€æ•°é‡
    heat_score: 98,            â† çƒ­åº¦æŒ‡æ•°
    trend: "rising",           â† è¶‹åŠ¿åˆ†æ
    last_update: "10-12 10:00" â† æ¯å°æ—¶æ›´æ–°
  }
end note

note top of Media
  **ç»Ÿä¸€åª’ä½“ç®¡ç† + ç”¨æˆ·è¡Œä¸º**
  
  â€¢ æ‰€æœ‰å›¾ç‰‡/è§†é¢‘/éŸ³é¢‘ç»Ÿä¸€ç®¡ç†
  â€¢ CDNåŠ é€Ÿåˆ†å‘+è‡ªåŠ¨ç¼©ç•¥å›¾
  
  **ç”¨æˆ·è¡Œä¸ºåœºæ™¯**
  ğŸ“± ä¸Šä¼ å¤´åƒï¼šæ‹ç…§/ç›¸å†Œâ†’è£å‰ªâ†’å‹ç¼©â†’ä¸Šä¼ CDN
  ğŸ“± å‘å¸ƒåŠ¨æ€ï¼šé€‰æ‹©9å¼ å›¾ç‰‡â†’ä¸Šä¼ â†’å…³è”åˆ°Content
  ğŸ“± å‘é€å›¾ç‰‡ï¼šèŠå¤©å‘å›¾â†’ä¸Šä¼ â†’å…³è”åˆ°ChatMessage
  ğŸ“± è¯­éŸ³è¯•å¬ï¼šå½•åˆ¶è¯­éŸ³æ ·æœ¬â†’ä¸Šä¼ â†’æŠ€èƒ½å±•ç¤º
  ğŸ“± æŸ¥çœ‹å¤§å›¾ï¼šç‚¹å‡»å›¾ç‰‡â†’å…¨å±æŸ¥çœ‹â†’æ‰‹åŠ¿ç¼©æ”¾
  
  **metadataå­˜å‚¨ç¤ºä¾‹**
  {
    size: 524288,      â† æ–‡ä»¶å¤§å°(å­—èŠ‚)
    width: 1920,       â† å›¾ç‰‡å®½åº¦
    height: 1080,      â† å›¾ç‰‡é«˜åº¦  
    duration: 120,     â† è§†é¢‘æ—¶é•¿(ç§’)
    format: "jpg"      â† æ–‡ä»¶æ ¼å¼
  }
end note

note top of Notification
  **é€šçŸ¥ä¸­å¿ƒè®¾è®¡ + ç”¨æˆ·è¡Œä¸º**
  
  typeåˆ†ç±»é€šçŸ¥ç±»å‹ï¼š
  1=ç‚¹èµé€šçŸ¥
  2=è¯„è®ºé€šçŸ¥  
  3=å…³æ³¨é€šçŸ¥
  4=ç³»ç»Ÿé€šçŸ¥
  
  **ç”¨æˆ·è¡Œä¸ºåœºæ™¯**
  ğŸ“± æŸ¥çœ‹é€šçŸ¥ï¼šæ¶ˆæ¯é¡µ4ä¸ªåŠŸèƒ½å¡ç‰‡åˆ†ç±»å±•ç¤º
  ğŸ“± ç‚¹å‡»é€šçŸ¥ï¼šè·³è½¬åˆ°åŸå†…å®¹/ç”¨æˆ·è¯¦æƒ…é¡µ
  ğŸ“± æ ‡è®°å·²è¯»ï¼šæŸ¥çœ‹åè‡ªåŠ¨æ ‡è®°is_read=1
  ğŸ“± æ¸…ç©ºé€šçŸ¥ï¼šä¸€é”®æ¸…é™¤ç¡®è®¤â†’æ‰¹é‡åˆ é™¤
  ğŸ“± å¤„ç†é€šçŸ¥ï¼šç³»ç»Ÿé€šçŸ¥çš„"ç«‹å³å®Œå–„"æŒ‰é’®
  
  **data JSONæ‰©å±• - ä¸°å¯Œé€šçŸ¥ä¿¡æ¯**
  {
    sender_id: 456,
    sender_name: "ç”¨æˆ·åç§°123",
    sender_avatar: "https://...",
    content_id: 789,
    content_preview: "è¯·ä½ ä»¬çœ‹é›ª",
    action_type: "like",
    thumbnail: "https://..."
  }
end note

note bottom of UserTag
  **å¤šç»´æ ‡ç­¾ç³»ç»Ÿ + ç”¨æˆ·è¡Œä¸º**
  
  tag_typeæ ‡ç­¾ç±»å‹ï¼š
  1=æŠ€èƒ½æ ‡ç­¾(ç‹è€…è£è€€/æ¢åº—/æŒ‰æ‘©)
  2=èŒä¸šæ ‡ç­¾(æ¨¡ç‰¹/å­¦ç”Ÿ/è‡ªç”±èŒä¸š)
  3=è®¤è¯æ ‡ç­¾(å®åè®¤è¯/å¤§ç¥è®¤è¯)
  4=å…´è¶£æ ‡ç­¾(Kæ­Œ/å°çƒ/å¥èº«)
  
  **ç”¨æˆ·è¡Œä¸ºåœºæ™¯**
  ğŸ“± æ·»åŠ æŠ€èƒ½ï¼šä¸ªäººä¸»é¡µâ†’æ·»åŠ æŠ€èƒ½â†’é€‰æ‹©æ¸¸æˆ/æœåŠ¡
  ğŸ“± ç®¡ç†èŒä¸šï¼šç¼–è¾‘èµ„æ–™â†’èŒä¸šæ ‡ç­¾â†’æ·»åŠ /åˆ é™¤(æœ€å¤š5ä¸ª)
  ğŸ“± è·å¾—è®¤è¯ï¼šå®åè®¤è¯â†’ä¸Šä¼ èº«ä»½è¯â†’å®¡æ ¸é€šè¿‡
  ğŸ“± æ ‡ç­¾ç­›é€‰ï¼šé¦–é¡µç­›é€‰â†’æŒ‰æŠ€èƒ½æ ‡ç­¾ç­›é€‰ç”¨æˆ·
  ğŸ“± ä¸ªæ€§æ¨èï¼šåŸºäºæ ‡ç­¾çš„æ™ºèƒ½åŒ¹é…ç®—æ³•
  
  **metadataæ‰©å±• - æ ‡ç­¾é¢å¤–ä¿¡æ¯**
  æŠ€èƒ½: {level:'è£è€€ç‹è€…', verified:true, score:95}
  èŒä¸š: {industry:'å¨±ä¹', experience:3}
  è®¤è¯: {verify_time:'2025-10-01', cert_no:'***'}
end note

note bottom of Report
  **å®‰å…¨å®¡æ ¸æœºåˆ¶ + ç”¨æˆ·è¡Œä¸º**
  
  â€¢ æ”¯æŒå¤šç›®æ ‡ä¸¾æŠ¥
  â€¢ 6ç±»ä¸¾æŠ¥ç†ç”±
  â€¢ 24å°æ—¶å¤„ç†æ‰¿è¯º
  
  **ç”¨æˆ·è¡Œä¸ºåœºæ™¯**
  ğŸ“± ä¸¾æŠ¥åŠ¨æ€ï¼šç‚¹å‡»æ›´å¤šâ†’é€‰æ‹©ä¸¾æŠ¥â†’é€‰ç†ç”±â†’å¡«è¯´æ˜
     â†’ åƒåœ¾ä¿¡æ¯/ä¸å½“å†…å®¹/ä¾µæƒ/è™šå‡/éªšæ‰°/å…¶ä»–
  ğŸ“± ä¸¾æŠ¥ç”¨æˆ·ï¼šç”¨æˆ·è¯¦æƒ…é¡µâ†’ä¸¾æŠ¥â†’æäº¤è¯æ®
  ğŸ“± ä¸¾æŠ¥è¯„è®ºï¼šè¯„è®ºè¯¦æƒ…â†’ä¸¾æŠ¥ä¸å½“è¯„è®º
  ğŸ“± æŸ¥çœ‹è¿›åº¦ï¼šæˆ‘çš„ä¸¾æŠ¥â†’æŸ¥çœ‹å¤„ç†çŠ¶æ€
  ğŸ“± å®¡æ ¸å¤„ç†ï¼šç®¡ç†å‘˜å®¡æ ¸â†’statusæ›´æ–°â†’é€šçŸ¥ç»“æœ
  
  **evidence JSONå­˜å‚¨è¯æ®**
  {
    screenshots: ['url1', 'url2'],  â† æˆªå›¾è¯æ®
    description: "è¯¦ç»†è¯´æ˜",
    category: "è‰²æƒ…å†…å®¹"
  }
end note

note bottom of SearchHistory
  **æœç´¢ä¼˜åŒ–æ”¯æŒ + ç”¨æˆ·è¡Œä¸º**
  
  â€¢ è®°å½•æœç´¢è¡Œä¸º
  â€¢ æ”¯æŒæœç´¢å†å²å±•ç¤º
  â€¢ çƒ­é—¨æœç´¢ç»Ÿè®¡
  
  **ç”¨æˆ·è¡Œä¸ºåœºæ™¯**
  ğŸ“± æœç´¢ç”¨æˆ·ï¼šè¾“å…¥å…³é”®è¯â†’æœç´¢â†’è®°å½•å†å²
  ğŸ“± æœç´¢è¯é¢˜ï¼šæœç´¢#è¯é¢˜â†’æ˜¾ç¤ºç›¸å…³è¯é¢˜
  ğŸ“± å†å²è®°å½•ï¼šæ˜¾ç¤ºæœ€è¿‘10æ¡æœç´¢â†’ç‚¹å‡»å¿«é€Ÿæœç´¢
  ğŸ“± çƒ­é—¨æœç´¢ï¼šå±•ç¤ºå¹³å°çƒ­æœè¯â†’ç‚¹å‡»æœç´¢
  ğŸ“± æ¸…ç©ºå†å²ï¼šé•¿æŒ‰åˆ é™¤å•æ¡/ä¸€é”®æ¸…ç©ºå…¨éƒ¨
  
  **search_typeåˆ†ç±»**
  1=ç”¨æˆ·æœç´¢ â†’ æœç´¢æ˜µç§°/ID
  2=å†…å®¹æœç´¢ â†’ æœç´¢åŠ¨æ€å†…å®¹
  3=è¯é¢˜æœç´¢ â†’ æœç´¢è¯é¢˜æ ‡ç­¾
  
  æœ€å¤šä¿ç•™10æ¡ï¼Œè¶…å‡ºè‡ªåŠ¨åˆ é™¤æœ€æ—©è®°å½•
end note

' ===== æ‰©å±•ä¿¡æ¯æ³¨é‡Š =====

note top of User
  **ç³»ç»Ÿæ ¸å¿ƒå®ä½“ + ç”¨æˆ·è¡Œä¸º**
  
  â€¢ æ‰€æœ‰ä¸šåŠ¡æ¨¡å—çš„åŸºç¡€
  â€¢ æ”¯æŒå¤šè§’è‰²èº«ä»½åˆ‡æ¢
  â€¢ ç»Ÿä¸€çš„ç”¨æˆ·çŠ¶æ€ç®¡ç†
  
  **ç”¨æˆ·è¡Œä¸ºåœºæ™¯**
  ğŸ“± ç™»å½•æ³¨å†Œï¼šè¾“å…¥æ‰‹æœºå·+å¯†ç /éªŒè¯ç 
  ğŸ“± åˆ‡æ¢è§’è‰²ï¼šæ—¢æ˜¯ä¹°å®¶åˆæ˜¯å–å®¶
  ğŸ“± å‘å¸ƒå†…å®¹ï¼šåˆ›å»ºåŠ¨æ€/æ´»åŠ¨/æŠ€èƒ½æœåŠ¡
  ğŸ“± ç¤¾äº¤äº’åŠ¨ï¼šå…³æ³¨/è¢«å…³æ³¨/èŠå¤©/è¯„è®º
  ğŸ“± æœåŠ¡äº¤æ˜“ï¼šè´­ä¹°æœåŠ¡/æä¾›æœåŠ¡
end note

note top of Content
  **ä¸‡èƒ½å†…å®¹è®¾è®¡ + ç”¨æˆ·è¡Œä¸º**
  type=1: åŠ¨æ€å‘å¸ƒ
  type=2: æ´»åŠ¨ç®¡ç†  
  type=3: æŠ€èƒ½æœåŠ¡
  
  **ç”¨æˆ·è¡Œä¸ºåœºæ™¯**
  ğŸ“± å‘å¸ƒåŠ¨æ€ï¼šå†™æ–‡å­—+é€‰å›¾ç‰‡+åŠ è¯é¢˜+æ ‡åœ°ç‚¹
     â†’ data={text, topic_ids[], media_ids[], location}
  
  ğŸ“± å‘å¸ƒç»„å±€ï¼šé€‰ç±»å‹+è®¾æ—¶é—´+å®šåœ°ç‚¹+è®¾äººæ•°+å®šä»·æ ¼
     â†’ data={time, location, limit, price, requirements}
  
  ğŸ“± æ·»åŠ æŠ€èƒ½ï¼šé€‰æŠ€èƒ½+å®šä»·+è®¾æ®µä½+ä¸Šä¼ ä½œå“
     â†’ data={skill_type, price_list[], rank, heroes[]}
  
  ğŸ“± æµè§ˆå†…å®¹ï¼šä¸‹æ‹‰åˆ·æ–°+ç­›é€‰+ç‚¹èµ+è¯„è®º+åˆ†äº«
  ğŸ“± è¯é¢˜èšåˆï¼šç‚¹å‡»è¯é¢˜â†’æŸ¥è¯¢è¯¥è¯é¢˜æ‰€æœ‰åŠ¨æ€
  
  **data JSONçµæ´»æ‰©å±• - é¿å…åˆ›å»ºå¤šä¸ªä¸“ç”¨è¡¨**
  åŠ¨æ€type=1: {text, topic_ids[], location, media_ids[], at_users[]}
  æ´»åŠ¨type=2: {time, location, limit, price, requirements, tags[]}
  æŠ€èƒ½type=3: {skill_type, price_list[], rank, service_mode, heroes[]}
end note

note top of ChatConversation
  **ä¼šè¯ç±»å‹ç»Ÿä¸€ + ç”¨æˆ·è¡Œä¸º**
  type=1: ç§èŠä¼šè¯
  type=2: ç¾¤èŠä¼šè¯
  type=3: ç³»ç»Ÿé€šçŸ¥
  type=4: è®¢å•ä¼šè¯(æ‰©å±•)
  
  **ç”¨æˆ·è¡Œä¸ºåœºæ™¯**
  ğŸ“± å‘èµ·ç§èŠï¼šç‚¹å‡»ç§ä¿¡æŒ‰é’®â†’åˆ›å»ºä¼šè¯â†’å‘é€æ¶ˆæ¯
  ğŸ“± æ´»åŠ¨ç¾¤èŠï¼šæ´»åŠ¨æŠ¥åæˆåŠŸâ†’è‡ªåŠ¨åˆ›å»ºç¾¤èŠâ†’ç¾¤å†…æ²Ÿé€š
  ğŸ“± è®¢å•ä¼šè¯ï¼šä¸‹å•æˆåŠŸâ†’åˆ›å»ºè®¢å•ä¼šè¯â†’ä¹°å–åŒæ–¹æ²Ÿé€š
  ğŸ“± æ¶ˆæ¯ç®¡ç†ï¼šç½®é¡¶å¯¹è¯/å…æ‰“æ‰°/åˆ é™¤ä¼šè¯
  ğŸ“± å›¾ç‰‡äº’åŠ¨ï¼šå‘å›¾ç‰‡+å†™é…æ–‡â†’å¯¹æ–¹ç‚¹èµå›¾ç‰‡
  
  **metadataæ‰©å±•ç¤ºä¾‹**
  ç§èŠ: {muted:false, pinned:true, last_read_time}
  ç¾¤èŠ: {member_limit:6, join_mode:'invite', chat_rules}
  è®¢å•ä¼šè¯: {order_id:123, service_type:'game', seller_id:456}
  æ´»åŠ¨ç¾¤: {activity_id:789, current_members:3, max_members:6}
end note

' ==========================================
' ğŸ“Š æ•°æ®åº“è®¾è®¡æ€»ç»“
' ==========================================

note as DesignSummary
  **XYç›¸é‡æ´¾ 18è¡¨æ¶æ„æ€»è§ˆ**
  
  **æ ¸å¿ƒç”¨æˆ·æ¨¡å— (4è¡¨)**
  User, UserProfile, UserWallet, Transaction
  
  **å†…å®¹ç¤¾äº¤æ¨¡å— (3è¡¨)**
  Content, ContentAction, UserRelation
  
  **è¯é¢˜æ ‡ç­¾æ¨¡å— (2è¡¨)**
  Topic, UserTag
  
  **äº¤æ˜“æœåŠ¡æ¨¡å— (1è¡¨)**
  ServiceOrder
  
  **åª’ä½“æ–‡ä»¶æ¨¡å— (1è¡¨)**
  Media
  
  **é€šçŸ¥æ¨é€æ¨¡å— (1è¡¨)**
  Notification
  
  **å®‰å…¨å®¡æ ¸æ¨¡å— (1è¡¨)**
  Report
  
  **æœç´¢å†å²æ¨¡å— (1è¡¨)**
  SearchHistory
  
  **èŠå¤©æ¨¡å— (3è¡¨)**
  ChatConversation, ChatMessage, ChatParticipant
  
  **è®¾è®¡äº®ç‚¹**
  âœ… æ¨¡å—åŒ–æ¶æ„ï¼š7å¤§ä¸šåŠ¡æ¨¡å—æ¸…æ™°åˆ†ç¦»
  âœ… JSONæ‰©å±•ï¼šmetadata/data/statså­—æ®µçµæ´»æ‰©å±•
  âœ… å¤šæ€è®¾è®¡ï¼šContentè¡¨typeå­—æ®µæ”¯æŒå¤šç§å†…å®¹ç±»å‹
  âœ… å…³ç³»æ˜ç¡®ï¼šç»„åˆ/èšåˆ/å…³è”å…³ç³»è§„èŒƒä½¿ç”¨
  âœ… æ€§èƒ½ä¼˜åŒ–ï¼šè®¡ç®—ä¼˜äºå­˜å‚¨ï¼Œé¿å…æ•°æ®å†—ä½™
  âœ… å®‰å…¨å®Œå–„ï¼šä¸¾æŠ¥å®¡æ ¸ã€å†…å®¹ç®¡ç†ã€æƒé™æ§åˆ¶
  
  **æ”¯æŒåŠŸèƒ½**
  âœ… é¦–é¡µï¼šæœåŠ¡å±•ç¤ºã€æ™ºèƒ½æ¨èã€åœ°ç†ä½ç½®ç­›é€‰
  âœ… å‘ç°ï¼šåŠ¨æ€æµã€è¯é¢˜èšåˆã€è¯„è®ºç³»ç»Ÿã€ä¸¾æŠ¥ç®¡ç†
  âœ… æ¶ˆæ¯ï¼šç§èŠç¾¤èŠã€åˆ†ç±»é€šçŸ¥ã€å®æ—¶æ¨é€ã€å¤šç«¯åŒæ­¥
  âœ… ä¸ªäººï¼šèµ„æ–™å±•ç¤ºã€ç¼–è¾‘ç®¡ç†ã€æŠ€èƒ½æœåŠ¡ã€ç¤¾äº¤æ•°æ®
  âœ… äº¤æ˜“ï¼šæœåŠ¡è®¢å•ã€æ”¯ä»˜æµç¨‹ã€è®¢å•èŠå¤©ã€è¯„ä»·ç³»ç»Ÿ
end note

' ==========================================
' ğŸ¯ ç”¨æˆ·è¡Œä¸ºåœºæ™¯æ˜ å°„
' ==========================================

note as UserScenarios
  **å…¸å‹ç”¨æˆ·è¡Œä¸º â†’ æ•°æ®è¡¨æ˜ å°„**
  
  **åœºæ™¯1: ç”¨æˆ·æ³¨å†Œç™»å½•**
  ğŸ“± ç”¨æˆ·æ“ä½œï¼šè¾“å…¥æ‰‹æœºå·+éªŒè¯ç ç™»å½•
  ğŸ’¾ æ•°æ®æ“ä½œï¼š
    â†’ Userè¡¨ï¼šåˆ›å»ºç”¨æˆ·è®°å½•(mobile/password/status)
    â†’ UserProfileè¡¨ï¼šåˆ›å»ºç”¨æˆ·èµ„æ–™(nickname/avatar)
    â†’ UserWalletè¡¨ï¼šåˆå§‹åŒ–é’±åŒ…(balance=0)
  
  **åœºæ™¯2: å®Œå–„ä¸ªäººèµ„æ–™**
  ğŸ“± ç”¨æˆ·æ“ä½œï¼šç¼–è¾‘æ˜µç§°/å¤´åƒ/æ€§åˆ«/ç”Ÿæ—¥/èº«é«˜ç­‰
  ğŸ’¾ æ•°æ®æ“ä½œï¼š
    â†’ Mediaè¡¨ï¼šä¸Šä¼ å¤´åƒæ–‡ä»¶(file_type=1)
    â†’ UserProfileè¡¨ï¼šæ›´æ–°metadata JSON
       {gender, birthday, height, weight, city, wechat}
    â†’ UserTagè¡¨ï¼šæ·»åŠ èŒä¸šæ ‡ç­¾(tag_type=2, tag_value='æ¨¡ç‰¹')
    â†’ UserTagè¡¨ï¼šæ·»åŠ è®¤è¯(tag_type=3, tag_value='å®åè®¤è¯')
  
  **åœºæ™¯3: å‘ç°é¡µå‘å¸ƒåŠ¨æ€**
  ğŸ“± ç”¨æˆ·æ“ä½œï¼šå†™æ–‡å­—+ä¸Šä¼ å›¾ç‰‡+é€‰è¯é¢˜+æ ‡è®°åœ°ç‚¹
  ğŸ’¾ æ•°æ®æ“ä½œï¼š
    â†’ Mediaè¡¨ï¼šä¸Šä¼ 9å¼ å›¾ç‰‡(file_type=1)
    â†’ Contentè¡¨ï¼šåˆ›å»ºåŠ¨æ€(type=1)
       data = {text, topic_ids:[123], media_ids:[456,789], 
               location:'æ·±åœ³å¸‚å—å±±åŒº'}
    â†’ Topicè¡¨ï¼šæ›´æ–°è¯é¢˜ç»Ÿè®¡stats.post_count++
    â†’ Notificationè¡¨ï¼šé€šçŸ¥å…³æ³¨è€…(type=ç³»ç»Ÿæ¨é€)
  
  **åœºæ™¯4: è¯é¢˜è¯¦æƒ…é¡µæµè§ˆ**
  ğŸ“± ç”¨æˆ·æ“ä½œï¼šç‚¹å‡»#S10å…¨çƒæ€»å†³èµ›è¯é¢˜æ ‡ç­¾
  ğŸ’¾ æ•°æ®æ“ä½œï¼š
    â†’ Topicè¡¨ï¼šæŸ¥è¯¢è¯é¢˜ä¿¡æ¯å’Œstatsç»Ÿè®¡
    â†’ Contentè¡¨ï¼šWHERE JSON_CONTAINS(data, 'topic_id')
       èšåˆè¯¥è¯é¢˜ä¸‹æ‰€æœ‰åŠ¨æ€
    â†’ UserTagè¡¨ï¼šæŸ¥è¯¢ç”¨æˆ·æ ‡è¯†(æ€§åˆ«å¹´é¾„/äººæ°”æ ‡ç­¾)
    â†’ Mediaè¡¨ï¼šJOINåŠ è½½åŠ¨æ€å›¾ç‰‡è§†é¢‘
  
  **åœºæ™¯5: åŠ¨æ€è¯„è®ºäº’åŠ¨**
  ğŸ“± ç”¨æˆ·æ“ä½œï¼šç‚¹èµåŠ¨æ€+å‘è¯„è®º+å›å¤è¯„è®º
  ğŸ’¾ æ•°æ®æ“ä½œï¼š
    â†’ ContentActionè¡¨ï¼šè®°å½•ç‚¹èµ(action=1, data=null)
    â†’ ContentActionè¡¨ï¼šè®°å½•è¯„è®º(action=2, 
       data={'comment':'è¯„è®ºå†…å®¹', 'reply_to':null})
    â†’ ContentActionè¡¨ï¼šè®°å½•å›å¤(action=2,
       data={'comment':'å›å¤å†…å®¹', 'reply_to':parent_id})
    â†’ Notificationè¡¨ï¼šé€šçŸ¥ä½œè€…(type=1ç‚¹èµ/type=2è¯„è®º)
       data = {sender_id, content_id, action_type}
  
  **åœºæ™¯6: ä¸¾æŠ¥ä¸å½“å†…å®¹**
  ğŸ“± ç”¨æˆ·æ“ä½œï¼šä¸¾æŠ¥åŠ¨æ€+é€‰æ‹©ç†ç”±+å¡«å†™è¯´æ˜
  ğŸ’¾ æ•°æ®æ“ä½œï¼š
    â†’ Reportè¡¨ï¼šåˆ›å»ºä¸¾æŠ¥è®°å½•
       (reporter_id, target_id, target_type=2å†…å®¹,
        reason=2ä¸å½“å†…å®¹, description='å…·ä½“è¯´æ˜',
        evidence={'screenshots':['url1','url2']})
    â†’ Notificationè¡¨ï¼šé€šçŸ¥ç®¡ç†å‘˜å®¡æ ¸
    â†’ Contentè¡¨ï¼šå®¡æ ¸åå¯èƒ½æ›´æ–°status=2ä¸‹æ¶
  
  **åœºæ™¯7: æ¶ˆæ¯é¡µæŸ¥çœ‹é€šçŸ¥**
  ğŸ“± ç”¨æˆ·æ“ä½œï¼šç‚¹å‡»"èµå’Œæ”¶è—"å¡ç‰‡æŸ¥çœ‹é€šçŸ¥
  ğŸ’¾ æ•°æ®æ“ä½œï¼š
    â†’ Notificationè¡¨ï¼šæŸ¥è¯¢(user_id=xxx, type=1ç‚¹èµ)
       ORDER BY created_at DESC
    â†’ User+UserProfileè¡¨ï¼šJOINè·å–ç‚¹èµç”¨æˆ·ä¿¡æ¯
    â†’ Contentè¡¨ï¼šJOINè·å–è¢«ç‚¹èµå†…å®¹é¢„è§ˆ
    â†’ Notificationè¡¨ï¼šæ›´æ–°is_read=1å·²è¯»çŠ¶æ€
  
  **åœºæ™¯8: ç§èŠå‘å›¾ç‰‡æ¶ˆæ¯**
  ğŸ“± ç”¨æˆ·æ“ä½œï¼šé€‰å›¾ç‰‡+å†™é…æ–‡+å‘é€+å¯¹æ–¹ç‚¹èµå›¾ç‰‡
  ğŸ’¾ æ•°æ®æ“ä½œï¼š
    â†’ Mediaè¡¨ï¼šä¸Šä¼ å›¾ç‰‡(file_type=1, uploader_id)
    â†’ ChatMessageè¡¨ï¼šå‘é€æ¶ˆæ¯(message_type=2,
       content='è¯·ä½ ä»¬çœ‹é›ª',
       media_data={'media_id':123, 'like_count':0, 'like_users':[]})
    â†’ ChatMessageè¡¨ï¼šç‚¹èµæ›´æ–°JSON
       media_data.like_count++, like_users.push(user_id)
    â†’ ChatParticipantè¡¨ï¼šæ›´æ–°å¯¹æ–¹æœªè¯»è®¡æ•°
  
  **åœºæ™¯9: ç‹è€…è£è€€é™ªç©ä¸‹å•**
  ğŸ“± ç”¨æˆ·æ“ä½œï¼šæœç´¢é™ªç©å¸ˆ+æŸ¥çœ‹è¯¦æƒ…+ä¸‹å•+æ”¯ä»˜+èŠå¤©
  ğŸ’¾ æ•°æ®æ“ä½œï¼š
    â†’ SearchHistoryè¡¨ï¼šè®°å½•æœç´¢(keyword='ç‹è€…è£è€€', type=1)
    â†’ UserTagè¡¨ï¼šç­›é€‰æŠ€èƒ½(tag_type=1, tag_value='ç‹è€…è£è€€')
    â†’ Contentè¡¨ï¼šæŸ¥è¯¢æŠ€èƒ½æœåŠ¡(type=3, data.skill_type='ç‹è€…')
    â†’ ServiceOrderè¡¨ï¼šåˆ›å»ºè®¢å•(buyer_id, seller_id, amount)
    â†’ UserWalletè¡¨ï¼šæ‰£æ¬¾(balance -= amount, version++)
    â†’ Transactionè¡¨ï¼šè®°å½•æµæ°´(amount=-1500, type='consume')
    â†’ ChatConversationè¡¨ï¼šåˆ›å»ºè®¢å•ä¼šè¯(type=4,
       metadata={'order_id':xxx})
    â†’ ChatParticipantè¡¨ï¼šæ·»åŠ ä¹°å–åŒæ–¹ä¸ºæˆå‘˜
  
  **åœºæ™¯10: ç»„å±€ä¸­å¿ƒå‘å¸ƒæ´»åŠ¨**
  ğŸ“± ç”¨æˆ·æ“ä½œï¼šå‘å¸ƒKæ­Œæ´»åŠ¨+è®¾ç½®æ—¶é—´åœ°ç‚¹+æ”¶è´¹æ ‡å‡†
  ğŸ’¾ æ•°æ®æ“ä½œï¼š
    â†’ Mediaè¡¨ï¼šä¸Šä¼ æ´»åŠ¨å°é¢å›¾
    â†’ Contentè¡¨ï¼šåˆ›å»ºæ´»åŠ¨(type=2,
       data={time:'2025-10-15 19:00', location:'æ™¯ç”°åœ¨çº¿ç½‘å’–',
             limit:6, price:6800, requirements:{gender:'mixed'}})
    â†’ ContentActionè¡¨ï¼šå…¶ä»–ç”¨æˆ·æŠ¥å(action=6,
       data={name:'å¼ ä¸‰', phone:'138***', gender:'male'})
    â†’ ServiceOrderè¡¨ï¼šæŠ¥åæˆåŠŸåˆ›å»ºè®¢å•
    â†’ ChatConversationè¡¨ï¼šåˆ›å»ºæ´»åŠ¨ç¾¤èŠ(type=2)
  
  **åœºæ™¯11: ä¸ªäººä¸»é¡µTabåˆ‡æ¢**
  ğŸ“± ç”¨æˆ·æ“ä½œï¼šæŸ¥çœ‹åŠ¨æ€/æ”¶è—/ç‚¹èµ/èµ„æ–™4ä¸ªTab
  ğŸ’¾ æ•°æ®æ“ä½œï¼š
    â†’ TabåŠ¨æ€ï¼šContent WHERE user_id=xxx AND type=1
    â†’ Tabæ”¶è—ï¼šContentAction WHERE user_id=xxx AND action=æ”¶è—
       JOIN Contentè·å–æ”¶è—å†…å®¹
    â†’ Tabç‚¹èµï¼šContentAction WHERE user_id=xxx AND action=1
       JOIN Contentè·å–ç‚¹èµå†…å®¹  
    â†’ Tabèµ„æ–™ï¼šUserProfile + UserTag(æŠ€èƒ½/èŒä¸šæ ‡ç­¾)
    â†’ ç¤¾äº¤æ•°æ®ï¼šUserRelation COUNTè®¡ç®—å…³æ³¨æ•°/ç²‰ä¸æ•°
  
  **åœºæ™¯12: æŠ€èƒ½æœåŠ¡ç®¡ç†**
  ğŸ“± ç”¨æˆ·æ“ä½œï¼šæ·»åŠ æŠ€èƒ½+å®šä»·+è®¾ç½®æ®µä½+ä¸Šçº¿æœåŠ¡
  ğŸ’¾ æ•°æ®æ“ä½œï¼š
    â†’ UserTagè¡¨ï¼šæ·»åŠ æŠ€èƒ½æ ‡ç­¾(tag_type=1,
       tag_value='ç‹è€…è£è€€',
       metadata={'level':'è£è€€ç‹è€…', 'verified':true})
    â†’ Contentè¡¨ï¼šåˆ›å»ºæŠ€èƒ½æœåŠ¡(type=3,
       data={skill_type:'ç‹è€…è£è€€', price:1500,
             rank:'è£è€€ç‹è€…', service_mode:'online'})
    â†’ Mediaè¡¨ï¼šä¸Šä¼ æ®µä½æˆªå›¾/ä¸ªäººç›¸å†Œ
end note

' ==========================================
' ğŸ“Š æ ¸å¿ƒä¸šåŠ¡æµç¨‹è¯´æ˜
' ==========================================

note as BusinessFlows
  **å…³é”®ä¸šåŠ¡æµç¨‹æ•°æ®æµè½¬**
  
  **æµç¨‹A: å‘ç°é¡µå®Œæ•´äº’åŠ¨é“¾è·¯**
  ç”¨æˆ·æµè§ˆåŠ¨æ€ â†’ ç‚¹èµè¯„è®º â†’ å…³æ³¨ä½œè€… â†’ ç§ä¿¡æ²Ÿé€š
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ 1. Contentè¡¨ï¼šåŠ è½½åŠ¨æ€åˆ—è¡¨(type=1)        â”‚
  â”‚    â”œâ”€ JOIN User+UserProfileï¼šä½œè€…ä¿¡æ¯     â”‚
  â”‚    â”œâ”€ JOIN Topicï¼šè¯é¢˜æ ‡ç­¾                â”‚
  â”‚    â””â”€ JOIN Mediaï¼šå›¾ç‰‡è§†é¢‘                â”‚
  â”‚                                          â”‚
  â”‚ 2. ContentActionè¡¨ï¼šç”¨æˆ·ç‚¹èµ(action=1)   â”‚
  â”‚    â””â”€ Notificationè¡¨ï¼šé€šçŸ¥ä½œè€…            â”‚
  â”‚                                          â”‚
  â”‚ 3. ContentActionè¡¨ï¼šç”¨æˆ·è¯„è®º(action=2)   â”‚
  â”‚    â”œâ”€ data={'comment':'...', 'reply_to':null}â”‚
  â”‚    â””â”€ Notificationè¡¨ï¼šé€šçŸ¥ä½œè€…(type=2)   â”‚
  â”‚                                          â”‚
  â”‚ 4. UserRelationè¡¨ï¼šå…³æ³¨ä½œè€…(type=1)      â”‚
  â”‚    â””â”€ Notificationè¡¨ï¼šé€šçŸ¥è¢«å…³æ³¨è€…(type=3)â”‚
  â”‚                                          â”‚
  â”‚ 5. ChatConversationè¡¨ï¼šåˆ›å»ºç§èŠä¼šè¯      â”‚
  â”‚    â”œâ”€ ChatParticipantè¡¨ï¼šæ·»åŠ åŒæ–¹æˆå‘˜     â”‚
  â”‚    â””â”€ ChatMessageè¡¨ï¼šå‘é€æ¶ˆæ¯             â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  
  **æµç¨‹B: æœåŠ¡äº¤æ˜“å®Œæ•´é“¾è·¯**
  æµè§ˆé™ªç©å¸ˆ â†’ æŸ¥çœ‹è¯¦æƒ… â†’ ä¸‹å•æ”¯ä»˜ â†’ è®¢å•èŠå¤© â†’ æœåŠ¡è¯„ä»·
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ 1. UserTagè¡¨ï¼šç­›é€‰æŠ€èƒ½æ ‡ç­¾               â”‚
  â”‚    WHERE tag_type=1 AND tag_value='ç‹è€…'  â”‚
  â”‚                                          â”‚
  â”‚ 2. Contentè¡¨ï¼šæŸ¥è¯¢æŠ€èƒ½æœåŠ¡(type=3)       â”‚
  â”‚    data={price:1500, rank:'è£è€€ç‹è€…'}    â”‚
  â”‚                                          â”‚
  â”‚ 3. ServiceOrderè¡¨ï¼šåˆ›å»ºè®¢å•              â”‚
  â”‚    (buyer_id, seller_id, content_id,    â”‚
  â”‚     amount=1500, duration=2)            â”‚
  â”‚                                          â”‚
  â”‚ 4. UserWalletè¡¨ï¼šä¹°å®¶æ‰£æ¬¾               â”‚
  â”‚    balance -= 1500 (ä¹è§‚é”version++)     â”‚
  â”‚                                          â”‚
  â”‚ 5. Transactionè¡¨ï¼šè®°å½•äº¤æ˜“æµæ°´           â”‚
  â”‚    (amount=-1500, type='consume',       â”‚
  â”‚     ref_id=order_id)                    â”‚
  â”‚                                          â”‚
  â”‚ 6. ChatConversationè¡¨ï¼šè®¢å•ä¼šè¯(type=4)  â”‚
  â”‚    metadata={'order_id':xxx}            â”‚
  â”‚                                          â”‚
  â”‚ 7. ContentActionè¡¨ï¼šæœåŠ¡åè¯„ä»·(action=5) â”‚
  â”‚    data={'rating':5, 'comment':'...'}   â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  
  **æµç¨‹C: ç»„å±€æ´»åŠ¨å®Œæ•´é“¾è·¯**
  å‘å¸ƒæ´»åŠ¨ â†’ ç”¨æˆ·æŠ¥å â†’ æ”¯ä»˜è´¹ç”¨ â†’ æ´»åŠ¨ç¾¤èŠ â†’ æ´»åŠ¨å®Œæˆ
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ 1. Contentè¡¨ï¼šåˆ›å»ºæ´»åŠ¨(type=2)           â”‚
  â”‚    data={time, location, limit:6,       â”‚
  â”‚          price:6800, requirements}      â”‚
  â”‚                                          â”‚
  â”‚ 2. ContentActionè¡¨ï¼šç”¨æˆ·æŠ¥å(action=6)   â”‚
  â”‚    data={name, phone, gender, remark}   â”‚
  â”‚                                          â”‚
  â”‚ 3. ServiceOrderè¡¨ï¼šæ´»åŠ¨è®¢å•              â”‚
  â”‚    data={'activity_id':xxx, 'seat':3}   â”‚
  â”‚                                          â”‚
  â”‚ 4. UserWallet+Transactionï¼šæ”¯ä»˜å¤„ç†      â”‚
  â”‚                                          â”‚
  â”‚ 5. ChatConversationè¡¨ï¼šæ´»åŠ¨ç¾¤èŠ(type=2)  â”‚
  â”‚    metadata={'activity_id':xxx,         â”‚
  â”‚              'member_limit':6}          â”‚
  â”‚                                          â”‚
  â”‚ 6. ChatParticipantè¡¨ï¼šæ‰€æœ‰æŠ¥åè€…å…¥ç¾¤     â”‚
  â”‚    role=1æ™®é€šæˆå‘˜, creator_idä¸ºç¾¤ä¸»      â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  
  **æµç¨‹D: æ¶ˆæ¯é€šçŸ¥å®Œæ•´é“¾è·¯**
  è§¦å‘äº’åŠ¨ â†’ ç”Ÿæˆé€šçŸ¥ â†’ æ¨é€æ¶ˆæ¯ â†’ æŸ¥çœ‹å¤„ç†
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ è§¦å‘ç‚¹ï¼šContentAction(ç‚¹èµ/è¯„è®º)         â”‚
  â”‚        UserRelation(å…³æ³¨)                â”‚
  â”‚        ServiceOrder(è®¢å•çŠ¶æ€å˜æ›´)        â”‚
  â”‚          â†“                               â”‚
  â”‚ ç”Ÿæˆï¼šNotificationè¡¨åˆ›å»ºé€šçŸ¥è®°å½•         â”‚
  â”‚       type=1ç‚¹èµ/2è¯„è®º/3å…³æ³¨/4ç³»ç»Ÿ        â”‚
  â”‚       data={sender_id, content_id,      â”‚
  â”‚             sender_name, action_type}   â”‚
  â”‚          â†“                               â”‚
  â”‚ æ¨é€ï¼šWebSocketå®æ—¶æ¨é€                  â”‚
  â”‚       APNs/FCMç¦»çº¿æ¨é€                   â”‚
  â”‚          â†“                               â”‚
  â”‚ æŸ¥çœ‹ï¼šæ¶ˆæ¯é¡µ4ä¸ªåŠŸèƒ½å¡ç‰‡åˆ†ç±»å±•ç¤º           â”‚
  â”‚       ç‚¹å‡»é€šçŸ¥ â†’ è·³è½¬åŸå†…å®¹è¯¦æƒ…           â”‚
  â”‚          â†“                               â”‚
  â”‚ å¤„ç†ï¼šNotification.is_read=1å·²è¯»         â”‚
  â”‚       ç³»ç»Ÿé€šçŸ¥å¯èƒ½æœ‰actionæŒ‰é’®            â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
end note

' ==========================================
' ğŸ”„ æ•°æ®è®¡ç®—é€»è¾‘è¯´æ˜
' ==========================================

note as ComputeLogic
  **è®¡ç®—ä¼˜äºå­˜å‚¨ - å®æ—¶è®¡ç®—ç»Ÿè®¡æ•°æ®**
  
  **ç¤¾äº¤ç»Ÿè®¡è®¡ç®—**
  âœ“ ç”¨æˆ·å…³æ³¨æ•°ï¼š
    SELECT COUNT(*) FROM UserRelation 
    WHERE user_id=xxx AND type=1
  
  âœ“ ç”¨æˆ·ç²‰ä¸æ•°ï¼š
    SELECT COUNT(*) FROM UserRelation
    WHERE target_id=xxx AND type=1
  
  âœ“ å†…å®¹ç‚¹èµæ•°ï¼š
    SELECT COUNT(*) FROM ContentAction
    WHERE content_id=xxx AND action=1
  
  âœ“ å†…å®¹è¯„è®ºæ•°ï¼š
    SELECT COUNT(*) FROM ContentAction
    WHERE content_id=xxx AND action=2
  
  âœ“ æ´»åŠ¨æŠ¥åäººæ•°ï¼š
    SELECT COUNT(*) FROM ContentAction
    WHERE content_id=xxx AND action=6
  
  **è¯é¢˜çƒ­åº¦è®¡ç®—**
  Topic.stats JSONç¼“å­˜è®¡ç®—ç»“æœï¼š
  {
    "participant_count": COUNT(DISTINCT user_id),
    "post_count": COUNT(content_id),
    "heat_score": ç®—æ³•è®¡ç®—çƒ­åº¦å€¼,
    "last_update": "2025-10-12 10:00"
  }
  â†’ æ¯å°æ—¶é‡æ–°è®¡ç®—ä¸€æ¬¡ï¼Œé¿å…å®æ—¶è®¡ç®—å‹åŠ›
  
  **æœªè¯»æ¶ˆæ¯è®¡ç®—**
  âœ“ å¯¹è¯æœªè¯»æ•°ï¼š
    SELECT COUNT(*) FROM ChatMessage m
    WHERE m.conversation_id=xxx
    AND m.created_at > p.last_read_time
    AND m.sender_id != current_user
  
  âœ“ é€šçŸ¥æœªè¯»æ•°ï¼š
    SELECT COUNT(*) FROM Notification
    WHERE user_id=xxx AND is_read=0
    GROUP BY type
  
  **ç”¨æˆ·æ´»è·ƒåº¦è®¡ç®—**
  åŸºäºå¤šè¡¨ç»¼åˆè®¡ç®—ï¼š
  âœ“ å‘å¸ƒå†…å®¹æ•°ï¼šContentè¡¨COUNT
  âœ“ äº’åŠ¨æ¬¡æ•°ï¼šContentActionè¡¨COUNT  
  âœ“ æ¶ˆæ¯æ´»è·ƒï¼šChatMessageè¡¨COUNT
  âœ“ ç¤¾äº¤å…³ç³»ï¼šUserRelationè¡¨COUNT
  â†’ å­˜å‚¨åˆ°UserProfile.metadata.activity_score
end note

' ==========================================
' ğŸ¨ JSONå­—æ®µä½¿ç”¨ç¤ºä¾‹
' ==========================================

note as JSONExamples
  **JSONå­—æ®µçµæ´»æ‰©å±•ç¤ºä¾‹**
  
  **Content.data åŠ¨æ€æ‰©å±•**
  // åŠ¨æ€å‘å¸ƒ type=1
  {
    "text": "è¯·ä½ ä»¬çœ‹é›ªâ„ï¸",
    "topic_ids": [123, 456],
    "media_ids": [789, 790, 791],
    "location": "æ²³åŒ—",
    "at_users": [111, 222],
    "visibility": "public"
  }
  
  // Kæ­Œç»„å±€ type=2
  {
    "title": "Kæ­Œä¸¤å°æ—¶",
    "time": "2025-10-15 19:00:00",
    "location": "æ™¯ç”°åœ¨çº¿ç½‘å’–",
    "address": "æ·±åœ³å¸‚å—å±±åŒºæ¾åªå±±ä¹ŒçŸ³å¤´è·¯11å·3å±‚",
    "limit": 6,
    "current_count": 3,
    "price": 6800,
    "fee_detail": {"åœºåœ°è´¹": 3000, "é¥®å“è´¹": 2000, "å…¶ä»–": 1800},
    "requirements": {
      "gender": "mixed",
      "age_range": [18, 35],
      "skill_level": "ä¸é™"
    },
    "tags": ["æ–°æ‰‹å‹å¥½", "å®šæœŸç»„å±€"],
    "cover_image_id": 888
  }
  
  // ç‹è€…é™ªç© type=3
  {
    "skill_type": "ç‹è€…è£è€€",
    "service_mode": "online",
    "price_list": [
      {"service": "ä¸Šåˆ†", "price": 1500, "unit": "å±€"},
      {"service": "è¯­éŸ³é™ªç©", "price": 1000, "unit": "å°æ—¶"}
    ],
    "rank": "è£è€€ç‹è€…",
    "position": ["å°„æ‰‹", "æ‰“é‡"],
    "heroes": ["åç¾¿", "å…°é™µç‹"],
    "win_rate": 78,
    "voice_sample_id": 999,
    "gallery_ids": [101, 102, 103]
  }
  
  **UserProfile.metadata ç”¨æˆ·æ‰©å±•**
  {
    "email": "user@example.com",
    "real_name": "å¼ ä¸‰",
    "gender": "female",
    "birthday": "1999-09-29",
    "height": 170,
    "weight": 50,
    "city": "æ·±åœ³",
    "district": "å—å±±åŒº",
    "wechat": "sunny0713",
    "wechat_unlock": "follow_required",
    "bio": "è¿™é‡Œæ˜¯ä¸ªäººä»‹ç»",
    "ip_location": "å¹¿ä¸œ æ·±åœ³",
    "activity_score": 85,
    "last_online": "2025-10-12 15:30"
  }
  
  **Topic.stats è¯é¢˜ç»Ÿè®¡ç¼“å­˜**
  {
    "participant_count": 12000,
    "post_count": 35000,
    "heat_score": 98,
    "trend": "rising",
    "top_contributors": [123, 456, 789],
    "peak_time": "2025-10-10 20:00",
    "last_update": "2025-10-12 10:00",
    "related_topics": [111, 222]
  }
  
  **ChatMessage.media_data å›¾ç‰‡ç‚¹èµ**
  {
    "media_id": 789,
    "caption": "è¯·ä½ ä»¬çœ‹é›ª",
    "like_count": 88,
    "like_users": [111, 222, 333],
    "view_count": 256
  }
  
  **Notification.data é€šçŸ¥æ‰©å±•**
  {
    "sender_id": 456,
    "sender_name": "ç”¨æˆ·åç§°123",
    "sender_avatar": "https://cdn.../avatar.jpg",
    "content_id": 789,
    "content_preview": "è¯·ä½ ä»¬çœ‹é›ª",
    "action_type": "like",
    "thumbnail": "https://cdn.../thumb.jpg"
  }
  
  **ServiceOrder.data è®¢å•æ‰©å±•**
  {
    "service_type": "game_companion",
    "game_id": "ç‹è€…è£è€€",
    "requirements": "ä¸Šåˆ†æœåŠ¡",
    "appointment_time": "2025-10-12 20:00",
    "estimated_duration": 2,
    "buyer_note": "å¸Œæœ›æ¸©æŸ”é™ªèŠ",
    "seller_note": "æ”¶åˆ°ï¼Œå‡†æ—¶å¼€å§‹",
    "status_history": [
      {"status": 0, "time": "2025-10-12 19:00", "note": "è®¢å•åˆ›å»º"},
      {"status": 1, "time": "2025-10-12 19:05", "note": "æ”¯ä»˜æˆåŠŸ"}
    ]
  }
end note

@enduml